<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <link rel="icon" href="Res/fichier-2.svg" type="image/x-icon">  
<title>DeskWritter - PrismTools</title>
  <style>
    body, html {
      margin: 0;
      padding: 0;
      height: 100%;
      background-color: rgb(255, 255, 255);
    }
    #top-bar {
      background-color: rgba(168, 168, 168, 0.801);
      height: 5%;
      display: flex;
      justify-content: flex-start;
      align-items: center;
      padding-left: 10px;
      border-bottom-left-radius: 20px;
      border-bottom-right-radius: 20px;
      touch-action: manipulation; /* Empêche le zoom sur les appareils tactiles */
      overflow: hidden; /* Cache tout contenu qui déborde de la div */
    }
    #tool-contener-line1 {
        display: flex;
      justify-content: flex-start;
      align-items: center;
      
    }
    #tool-contener-line2 {
        display: flex;
      justify-content: flex-start;
      align-items: center;
    }
    #middle-bar {
      background-color: rgb(255, 255, 255);
      height: 13%;
      touch-action: manipulation; /* Empêche le zoom sur les appareils tactiles */
      overflow: hidden; /* Cache tout contenu qui déborde de la div */
    }
    #content {
      background: linear-gradient(to bottom, rgba(206, 206, 206, 0.521), rgba(104, 104, 104, 0.301));
      height: 82%;
      border-top-right-radius: 20px;
      border-top-left-radius: 20px;
      z-index: 9999;
      touch-action: manipulation; /* Empêche le zoom sur les appareils tactiles */
      overflow: auto; /* Cache tout contenu qui déborde de la div */
    }
    .button-with-image {
      height: 45px;
      width: 45px;
      background-color: transparent;
      border-color: transparent;
      cursor: pointer;
      display: inline-block;
      margin-right: 10px;
    }
    .button-with-image img {
      height: 30px;
      width: 30px;
    }
    .class1-button {
      height: 40px;
      width: 40px;
      background-color: transparent;
      border-color: transparent;
      cursor: pointer;
      display: inline-block;
      height: 40px;
    }
    .class1-button img {
      height: 20px;
      width: 20px;
    }
    #tool-container-text {
        background-color: white;
        width: 230px;
        height: 40px;
        border-radius: 50px;
        margin-top: 10px;
        margin-left: 10px;
        box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.253);
    }
    .class2-button {
      height: 40px;
      width: 40px;
      background-color: transparent;
      border-color: transparent;
      cursor: pointer;
      display: inline-block;
      margin-left: 5px;
    }
    .class2-button img {
      height: 20px;
      width: 20px;
    }
    #tool-container-text-adv {
        background-color: white;
        width: 153px;
        border-radius: 50px;
        margin-top: 10px;
        margin-left: 10px;
        box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.253);
    }
    #font-family {
        background-color: white;
        width: 200px;
        border-radius: 50px;
        margin-top: 10px;
        margin-left: 10px;
        height: 40px;
        border-color: transparent;
        text-align: center;
        box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.253);
    }
    #font-size {
        background-color: white;
        width: 80px;
        border-radius: 50px;
        margin-top: 10px;
        margin-left: 10px;
        height: 40px;
        border-color: transparent;
        text-align: center;
        box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.253);
    }
    #editor {
            background-color: #ffffff;
            border: 30px solid #ffffff;
            padding: 15px;
            font-family: Arial, sans-serif;
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.253);
            border-radius: 20px;
            width: 210mm;
            height: 297mm;
            margin-top: 50px;
            margin-left: 50%;
            transform: translateX(-50%);
            overflow: hidden;
            
        }
      .class2-button-solo {
      height: 40px;
      width: 40px;
      margin-top: 15px;
      background-color: transparent;
      border-color: transparent;
      cursor: pointer;
      display: inline-block;
    }
    .class2-button-solo img {
      height: 20px;
      width: 20px;
    }
    #apply-stand {
      margin-left: 12px;
    }
    #apply-stand-new-line {
      margin-left: 6px;
    }
    #tool-container-color {
      background-color: white;
      width: 310px;
      border-radius: 50px;
      margin-top: 10px;
      margin-left: 10px;
      box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.253);
      padding: 7.5px;
    }
    .class1-color-button {
      height: 25px;
      width: 25px;
      margin-left: 5px;
      border-radius: 50px;
      box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.253);
      border-color: transparent;
    }
    #black {
      background-color: black;
    }
    #red {
      background-color: rgb(202, 48, 48);
    }
    #orange {
      background-color: rgb(243, 162, 10);
    }
    #yellow {
      background-color: rgb(235, 235, 0);
    }
    #green {
      background-color: rgb(0, 134, 0);
    }
    #bluef {
      background-color: rgb(18, 18, 131);
    }
    #bluec {
      background-color: rgb(20, 141, 172);
    }
    #pink {
      background-color: pink;
    }
    #another {
      background: radial-gradient(circle, rgb(7, 165, 177), rgb(191, 219, 159), rgb(201, 223, 7));
    }
    #zoom-contener {
      background-color: rgba(255, 255, 255, 0.507);
      width: 300px;
      border-radius: 50px;
      margin-top: 10px;
      margin-left: 10px;
      box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.253);
      padding: 7.5px;
      height: 30px;
      position: absolute;
      bottom: 10px;
      right: 35px;
      z-index: 9999;
    }
    .barre-zoom {
      position: absolute;
      width: 60%;
      left: 55px;
      top: 13px;
    }

    #valeur-zoom {
      position: absolute;
      top: 14px;
      right: 13px;
    }
    #zoom-image {
      position: absolute;
      top: 13px;
      left: 20px;
      height: 20px;
      width: 20px;
      opacity: 0.5;
    }
    #loader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #ffffff;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 99999;
        }

        #loader img {
            width: 15%;
        }

        .bottom-content {
            text-align: center;
            margin: 20px 0;
            position: absolute;
            bottom: 0;
        }
        
.container h1 {
            text-align: center;
            font-size: 160%;
        }
        .container h2 {
          margin-top: -10px;
            text-align: center;
            font-size: 100%;
        }
        .container input {
            width: 95%;
            padding: 10px;
            margin-bottom: 10px;
            border: none;
            background: #eee;
            margin-top: 5%;
        }

        .container button {
            width: 30%;
            padding: 10px;
            border: none;
            background: #ff3333;
            color: white;
            cursor: pointer;
        }

        .container a {
            color: rgb(0, 0, 0);
            text-decoration: underline;
            cursor: pointer;
            border: none;
        }
        #createaccnt {
          width: 50%;
            padding: 10px;
            border: none;
            color: #ff3333;
            background-color: transparent;
            cursor: pointer;
            text-align: left;
        }
        .buttons-container {
    display: flex;
    justify-content: space-between; /* Alignement horizontal au centre */
    align-items: center; /* Alignement vertical au centre si nécessaire */
    margin-top: 10%;
    margin-bottom: 5%;
}
#image_logo {
    margin-left: 50%;
    transform: translateX(-50%);
}
#emailDisplayAt2 {
    text-align: center;
}
#emailText {
    color: grey;
    text-align: left;
    font-size: 12px;
}
#tool-container-text-b {
        background-color: white;
        width: 90px;
        height: 40px;
        border-radius: 50px;
        margin-top: 10px;
        margin-left: 10px;
        box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.253);
    }
    #menu {
            position: fixed;
            top: 0;
            left: -18%;
            width: 18%;
            height: 100%;
            background-color: #fff;
            transition: left 0.3s;
            z-index: 9999;
        }
    #emailDisplay {
      display: flex;
    justify-content: space-between; /* Alignement horizontal au centre */
    align-items: center; /* Alignement vertical au centre si nécessaire */
    margin-top: 10px;
    margin-left: 7px;
    margin-right: 7px;
    }
        /* Style pour la fenêtre modale */
.modal {
  display: none; /* Par défaut, la fenêtre modale est cachée */
  position: fixed;
  z-index: 1;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  overflow: auto;
  background-color: rgba(0,0,0,0.5); /* Fond semi-transparent */
}

/* Contenu de la fenêtre modale */
.modal-content {
  background-color: #fefefe;
  margin: 15% auto;
  padding: 20px;
  border: 1px solid #888;
  width: 50%; /* Largeur de la fenêtre modale */
  height: 50%;
}

/* Style pour le bouton de fermeture */
.close {
  color: #aaa;
  float: right;
  font-size: 28px;
  font-weight: bold;
}

.close:hover,
.close:focus {
  color: black;
  text-decoration: none;
  cursor: pointer;
}
/* Ajoutez du style pour les onglets et le contenu des onglets */
.tabcontent {
  display: none;
}

/* Style actif pour les onglets */
.tabcontent.active {
  display: block;
}

/* Style pour les boutons des onglets */
.tablinks {
  background-color: #f2f2f2;
  border: none;
  cursor: pointer;
  padding: 10px 20px;
}

.tablinks:hover {
  background-color: #ddd;
}
  </style>
</head>
<body>
  <div id="loader">
    <img src="Res/fichier-2.svg">
    <div class="bottom-content">
        <img src="Res/logo-text-big.png">
    </div>
</div>
  <div id="top-bar">
    <button class="button-with-image" id="menudev"><img src="Res/applications.png" alt="Image 1"></button>
    <button id="save" class="button-with-image"><img src="Res/save.png" alt="Image 2"></button>
    <button id="open" class="button-with-image"><img src="Res/open.png" alt="Image 4"></button>
    <input type="file" id="file-input" style="display: none;">
    <button class="button-with-image" id="openModalBtn"><img src="Res/settings-sliders.png" alt="Image 3"></button>
    <button class="button-with-image" onclick="openPopup()"><img src="Res/profile-user.png" alt="connexion au service"></button>
    <div id="menu" class="hidden">
      <div id="emailDisplay">
          <button id="menu-return-button" onclick="window.location.href = 'Start-Index-OfflineApp.html';">Retour au menu principale</button>
          <button id="Conn-btn" onclick="openPopup(); toggleMenu();">Connectez vous</button>
      </div>
      
  </div>

</div>
<div id="middle-bar">
<div id="tool-contener-line1">
    <div id="tool-container-text-adv">
        <button class="class2-button"><img src="Res/copy.png" alt="img"></button>
        <button class="class2-button"><img src="Res/paste.png" alt="img"></button>
        <button class="class2-button"><img src="Res/scissors.png" alt="img"></button>
    </div>
    <select id="font-family">
      <option value="Arial">Arial</option>
      <option value="Times New Roman">Times New Roman</option>
      <option value="Courier New">Courier New</option>
      <option value="Verdana">Verdana</option>
      <option value="Georgia">Georgia</option>
      <option value="Tahoma">Tahoma</option>
      <option value="Helvetica">Helvetica</option>
      <option value="Palatino">Palatino</option>
      <option value="Calibri">Calibri</option>
      <option value="Lucida Sans">Lucida Sans</option>
      <option value="Impact">Impact</option>
      <option value="Comic Sans MS">Comic Sans MS</option>
      <option value="Trebuchet MS">Trebuchet MS</option>
      <option value="Garamond">Garamond</option>
      <option value="Book Antiqua">Book Antiqua</option>
      <option value="Century Gothic">Century Gothic</option>
      <option value="Futura">Futura</option>
      <option value="Myriad Pro">Myriad Pro</option>
      <option value="Baskerville">Baskerville</option>
      <option value="Rockwell">Rockwell</option>
      <option value="Franklin Gothic">Franklin Gothic</option>
      <option value="Copperplate">Copperplate</option>
      <option value="Segoe UI">Segoe UI</option>
      <option value="Consolas">Consolas</option>
      <option value="Cambria">Cambria</option>
      <option value="Brush Script">Brush Script</option>
      <option vaue="Monospace">Monospace</option>
      <option value="Roboto">Roboto</option>
      <option value="Open Sans">Open Sans</option>
      <option value="Lato">Lato</option>
      <!-- autres polices ici -->
  </select>
  <select id="font-size">
      <option value="8">8</option>
      <option value="9">9</option>
      <option value="10">10</option>
      <option value="11">11</option>
      <option value="12">12</option>
      <option value="14">14</option>
      <option value="16">16</option>
      <option value="20">20</option>
      <option value="22">22</option>
      <option value="24">24</option>
      <option value="26">26</option>
      <option value="28">28</option>
      <option value="36">36</option>
      <option value="48">48</option>
      <option value="72">72</option>
  </select>
  <button id="apply-stand" class="class2-button-solo"><img src="Res/bold.png" alt="img"></button>
  <button class="class2-button-solo"><img src="Res/italic.png" alt="img"></button>
  <button class="class2-button-solo"><img src="Res/underline.png" alt="img"></button>
  <div id="tool-container-text-b">
    <button class="class1-button" id="unordered-list-button"><img src="Res/lister.png" alt="img"></button>
    <button class="class1-button" id="ordered-list-button"><img src="Res/listern-um.png" alt="img"></button>
    
  </div>
</div>

<div id="tool-contener-line2">
  <button id="apply-stand-new-line" class="class2-button-solo"><img src="Res/print.png" alt="img"></button>
  <button class="class2-button-solo"><img src="Res/eraser.png" alt="img"></button>
  <div id="tool-container-text">
    <button class="class1-button" style="margin-left: 5px;"><img src="Res/align-left.png" alt="img"></button>
    <button class="class1-button"><img src="Res/align-center.png" alt="img"></button>
    <button class="class1-button"><img src="Res/align-right.png" alt="img"></button>
    <button class="class1-button"><img src="Res/exposant.png" alt="img"></button>
    <button class="class1-button"><img src="Res/indice.png" alt="img"></button>
</div>
<div id="tool-container-color">
  <button id="black" class="class1-color-button" data-color="black"></button>
  <button id="red" class="class1-color-button" data-color="red"></button>
  <button id="orange" class="class1-color-button" data-color="orange"></button>
  <button id="yellow" class="class1-color-button" data-color="yellow"></button>
  <button id="green" class="class1-color-button" data-color="green"></button>
  <button id="bluec" class="class1-color-button" data-color="blue"></button>
  <button id="bluef" class="class1-color-button" data-color="blue"></button>
  <button id="pink" class="class1-color-button" data-color="pink"></button>
  <button id="another" class="class1-color-button"></button>
  <input type="color" id="custom-color-picker" style="display: none;">
</div>

</div>

</div>
  <div id="content">
    <div id="zoom-contener">
      <img id="zoom-image" src="Res/magnifier.png" alt="Zomm1">
      <input type="range" min="50" max="200" value="100" class="barre-zoom" id="zoomBar">
      <span id="valeur-zoom">100%</span>
    </div>
    <div id="editor" contenteditable="true"></div>
  </div>
  <div id="myModal" class="modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      
      <!-- Onglets -->
      <div class="tabs">
        <button class="tablinks" onclick="openTab(event, 'Page')">Page</button>
        <button class="tablinks" onclick="openTab(event, 'Insertion')">Insertion</button>
        <button class="tablinks" onclick="openTab(event, 'MiseEnPage')">Mise en page</button>
        <button class="tablinks" onclick="openTab(event, 'Autre')">Autre</button>
      </div>
      
      <!-- Contenu des onglets -->
      <div id="Page" class="tabcontent">
        <h3>Operation de pa page</h3>
        <button id="generatePdfBtn">Générer PDF</button>
        <!-- Ajoutez ici le contenu de l'onglet "Page" -->
      </div>
      
      <div id="Insertion" class="tabcontent">
        <h3>Insertion</h3>
        <h4>Inserer un tableau</h4>
        <label for="num-rows">Nombre de lignes :</label>
        <input type="number" id="num-rows" min="1" value="3"><br>
        <label for="num-cols">Nombre de colonnes :</label>
        <input type="number" id="num-cols" min="1" value="3"><br>
        <button id="insert-table-btn">Insérer un tableau</button>
        <h4>Inserer une image :</h4>
        <input type="file" id="image-input" accept="image/*">
        <button id="insert-image-btn">Insérer une image</button>
        <p>ATTENTION : Si votre image est plus grande que la zone de texte, elle sera automatiquement cachée</p>
      </div>
      
      <div id="MiseEnPage" class="tabcontent">
        <h3>Mise en page</h3>
      <h4>Orientation de la page :</h4>
      <label><input type="radio" name="orientation" value="portrait" checked> Portrait</label>
      <label><input type="radio" name="orientation" value="landscape"> Paysage</label>
      <p>Le type de feuille est actuellement 'A4'</p>
      <h4>Format de papier :</h4>
      <select id="paper-size">
        <option value="A4">A4</option>
        <option value="A5">A5</option>
        <option value="Letter">Lettre US</option>
        <option value="Legal">Legal US</option>
      </select>
      <h4>Marges :</h4>
      <select id="margin-size">
        <option value="narrow">Étroite (marge de 10mm)</option>
        <option value="normal" selected>Normale (marge de 20mm)</option>
        <option value="wide">Large (marge de 30mm)</option>
        <!-- Ajoutez d'autres options de marges si nécessaire -->
      </select>
      <ul>
        <li><strong>Étroite :</strong> Une marge de 10 mm.</li>
        <li><strong>Normale :</strong> Une marge de 20 mm.</li>
        <li><strong>Large :</strong> Une marge de 30 mm.</li>
      </ul>
      
      </div>
      
      <div id="Autre" class="tabcontent">
        <h3>Autre</h3>
        <!-- Ajoutez ici le contenu de l'onglet "Autre" -->
      </div>
    </div>
  </div>
<script>
//-----------------------------------------------------------------------Gestion de la connection a prismID-----------------------------------------------
      var popupWindow;
  
      // Fonction pour ouvrir la fenêtre contextuelle
      function openPopup() {
          var width = 500;
          var height = 600;
          var left = (window.innerWidth - width) / 2;
          var top = (window.innerHeight - height) / 2;
          var options = 'toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=' + width + ', height=' + height + ', top=' + top + ', left=' + left;
  
          popupWindow = window.open('ConnectionService-FirebasePupUp.html', 'Popup', options);
      }
  
      // Fonction appelée après la connexion réussie dans la fenêtre contextuelle
      function onLoginSuccess(userInfo) {
          // Extrayez l'e-mail de l'utilisateur
          var userEmail = userInfo.email;
          // Fermez la fenêtre contextuelle après traitement des informations
          if (popupWindow) {
              popupWindow.close();
          }
      }
  </script>
  <script>
    //------------------------------------------------------Gestion menu---------------------------------------------------------
    const menu = document.getElementById('menu');
const menudev = document.getElementById('menudev');

menudev.addEventListener('click', (event) => {
    event.stopPropagation(); // Arrête la propagation de l'événement pour éviter la fermeture immédiate du menu
    toggleMenu(); // Afficher ou masquer le menu
});

// Écouter les clics en dehors du menu pour le masquer
document.addEventListener('click', (event) => {
    const isClickInsideMenu = menu.contains(event.target);
    if (!isClickInsideMenu) {
        menu.style.left = "-18%"; // Masquer le menu si le clic est en dehors du menu
    }
});

function toggleMenu() {
    // Si le menu est actuellement affiché, masquez-le. Sinon, affichez-le.
    if (menu.style.left === "0px" || menu.style.left === "") {
        menu.style.left = "-18%"; // Masquer le menu
    } else {
        menu.style.left = "0"; // Afficher le menu
    }
}
    //------------------------------------------------------IMPRESSION-----------------------------------------------------------
    const printButton = document.getElementById('apply-stand-new-line');

// Ajoutez un écouteur d'événements au bouton d'impression
printButton.addEventListener('click', () => {
    const printContent = document.getElementById('editor').innerHTML;
    const printWindow = window.open('', '', 'width=600,height=600');
    printWindow.document.open();
    printWindow.document.write(`
        <html>
        <head>
            <title>Impression</title>
            <style>
                @page {
                    size: ${getPaperSize()} ${getOrientation()}; /* Définir la taille du papier et l'orientation */
                    margin: ${getMargin()}; /* Définir les marges */
                }
                body {
                    font-size: 12px; /* Définir la taille de la police */
                    margin: 0; /* Réinitialiser les marges du corps */
                }
            </style>
        </head>
        <body>
            ${printContent}
        </body>
        </html>
    `);
    printWindow.document.close();
    printWindow.print();
    printWindow.close();
});

// Fonction pour obtenir la taille du papier sélectionnée
function getPaperSize() {
    const paperSizeSelect = document.getElementById('paper-size');
    return paperSizeSelect.value;
}

// Fonction pour obtenir l'orientation sélectionnée
function getOrientation() {
    const orientationSelect = document.querySelector('input[name="orientation"]:checked');
    return orientationSelect.value;
}

// Fonction pour obtenir les marges sélectionnées
function getMargin() {
    const marginSelect = document.getElementById('margin-size');
    return marginSelect.value + 'mm'; // Suppose que les marges sont en millimètres
}
    //---------------------------------------------------ADVANCETEXTOPTION-----------------------------------------------------------
    // Sélection des boutons
    const alignLeftButton = document.querySelector('.class1-button:nth-of-type(1)');
    const alignCenterButton = document.querySelector('.class1-button:nth-of-type(2)');
    const alignRightButton = document.querySelector('.class1-button:nth-of-type(3)');
    const superscriptButton = document.querySelector('.class1-button:nth-of-type(4)');
    const subscriptButton = document.querySelector('.class1-button:nth-of-type(5)');
    const unorderedListButton = document.getElementById('unordered-list-button');
    const orderedListButton = document.getElementById('ordered-list-button');

    // Fonction pour récupérer la sélection de texte
    function getSelectedText() {
      return window.getSelection().toString();
    }

    // Écouteurs d'événements pour chaque bouton
    alignLeftButton.addEventListener('click', () => {
      document.execCommand('justifyLeft', false, null);
    });

    alignCenterButton.addEventListener('click', () => {
      document.execCommand('justifyCenter', false, null);
    });

    alignRightButton.addEventListener('click', () => {
      document.execCommand('justifyRight', false, null);
    });

    superscriptButton.addEventListener('click', () => {
      const selectedText = getSelectedText();
      if (selectedText) {
        document.execCommand('superscript', false, null);
      }
    });

    subscriptButton.addEventListener('click', () => {
      const selectedText = getSelectedText();
      if (selectedText) {
        document.execCommand('subscript', false, null);
      }
    });
    unorderedListButton.addEventListener('click', () => {
            document.execCommand('insertUnorderedList', false, null);
        });

    orderedListButton.addEventListener('click', () => {
            document.execCommand('insertOrderedList', false, null);
    });
    //-------------------------------------------------COPY/CUT/PAST-----------------------------------------------------------------
    // Sélection des boutons de la classe 2
    const copyButton = document.querySelector('.class2-button:nth-of-type(1)');
    const pasteButton = document.querySelector('.class2-button:nth-of-type(2)');
    const cutButton = document.querySelector('.class2-button:nth-of-type(3)');

    // Écouteurs d'événements pour chaque bouton
    copyButton.addEventListener('click', () => {
    const selectedText = getSelectedText();
    if (selectedText) {
      document.execCommand('copy');
    }
    });

    pasteButton.addEventListener('click', () => {
      document.execCommand('paste');
    });

    cutButton.addEventListener('click', () => {
      const selectedText = getSelectedText();
      if (selectedText) {
        document.execCommand('cut');
      }
    });
    //-----------------------------------------------BOLT/ITALIC/UNDERLINE----------------------------------------------------------
    // Sélection des boutons de la classe2-button-solo
    const boldButton = document.getElementById('apply-stand');
    const italicButton = document.querySelector('.class2-button-solo:nth-of-type(2)');
    const underlineButton = document.querySelector('.class2-button-solo:nth-of-type(3)');

    // Fonction pour vérifier si le texte est mis en forme
    function isApplied(command) {
      return document.queryCommandState(command);
    }

    // Écouteurs d'événements pour chaque bouton
    boldButton.addEventListener('click', () => {
    const selectedText = getSelectedText();
      if (selectedText) {
        document.execCommand('bold');
      }
    });

    italicButton.addEventListener('click', () => {
      const selectedText = getSelectedText();
      if (selectedText) {
        document.execCommand('italic');
      }
    });

    underlineButton.addEventListener('click', () => {
      const selectedText = getSelectedText();
      if (selectedText) {
        document.execCommand('underline');
      }
    });
    //-------------------------------------------------Taille de police-------------------------------------
    // Sélection des menus déroulants
    const fontFamilySelect = document.getElementById('font-family');
    const fontSizeSelect = document.getElementById('font-size');

    // Écouteurs d'événements pour chaque menu déroulant
    fontFamilySelect.addEventListener('change', () => {
      const selectedFont = fontFamilySelect.value;
      document.execCommand('fontName', false, selectedFont);
    });
    fontSizeSelect.addEventListener('change', () => {
    const selection = window.getSelection();
    if (selection.rangeCount > 0) {
        const range = selection.getRangeAt(0);
        const span = document.createElement('span');
        span.style.fontSize = fontSizeSelect.value + 'px'; // Ajoutez 'px' à la valeur de la taille de police
        range.surroundContents(span);
    }
});
    //-------------------------------------------------Save-------------------------------------------------
    const saveButton = document.getElementById('save');
const openButton = document.getElementById('open');
const fileInput = document.getElementById('file-input');
const editor = document.getElementById('editor');

saveButton.addEventListener('click', () => {
  const podxContent = editor.innerHTML;
  const blob = new Blob([podxContent], { type: 'application/podx' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = 'Document.podx';
  a.click();
  URL.revokeObjectURL(url);
  adjustEditorHeight()
});

openButton.addEventListener('click', () => {
  fileInput.click();
  adjustEditorHeight()
});

fileInput.addEventListener('change', () => {
  const file = fileInput.files[0];
  const reader = new FileReader();
  adjustEditorHeight()
  reader.onload = (event) => {
    const podxContent = event.target.result;
    editor.innerHTML = podxContent;
  };
  reader.readAsText(file);
  adjustEditorHeight()
});

//--------------------------------------------------color--------------------------------------------------------
const colorButtons = document.querySelectorAll('.class1-color-button');
const anotherColorButton = document.getElementById('another');
const customColorPicker = document.getElementById('custom-color-picker');

colorButtons.forEach(button => {
  button.addEventListener('click', () => {
    const color = button.dataset.color;
    applyColorToSelection(color);
  });
});

anotherColorButton.addEventListener('click', () => {
  customColorPicker.click();
});

customColorPicker.addEventListener('input', () => {
  const color = customColorPicker.value;
  applyColorToSelection(color);
});

function applyColorToSelection(color) {
  const selection = window.getSelection();
  if (selection.rangeCount > 0) {
    const range = selection.getRangeAt(0);
    const span = document.createElement('span');
    span.style.color = color;
    range.surroundContents(span);
  }
}
//---------------------------------------------------------------------ZOOM----------------------------------------
document.addEventListener('DOMContentLoaded', function() {
  var editor = document.getElementById('editor');
  var zoomBar = document.getElementById('zoomBar');
  var valeurZoom = document.getElementById('valeur-zoom');

  zoomBar.addEventListener('input', function() {
    var valeur = zoomBar.value;
    valeurZoom.textContent = valeur + '%';
    editor.style.transform = 'scale(' + valeur / 100 + ') translateX(-50%)'; // Appliquer le zoom et le centrage horizontal à la div de l'éditeur
    editor.style.marginLeft = '50%'; // Centrer horizontalement l'éditeur
  });
});
//--------------------------------------------GESTION PAGE----------------------------------------------------------
let previousHeight = editor.scrollHeight;

function adjustEditorHeight() {
  const currentHeight = editor.scrollHeight;

  if (currentHeight !== previousHeight) {
    editor.style.height = 'fit-content';
    previousHeight = currentHeight;
  }
}

// Appelez la fonction pour ajuster la hauteur au chargement initial et à chaque modification du contenu
window.addEventListener('DOMContentLoaded', adjustEditorHeight);
editor.addEventListener('input', adjustEditorHeight);

//---------------------------------------------Gestion du loader------------------------------------------------------
setTimeout(function() {
        var loader = document.getElementById('loader');
        loader.style.display = 'none';
        }, 0);
//----------------------------------------------Gestion du modal pour les parametre------------------------------------
// Fonction pour ouvrir un onglet spécifique
function openTab(event, tabName) {
  // Récupère tous les éléments avec la classe "tabcontent" et les masque
  const tabcontent = document.getElementsByClassName('tabcontent');
  for (let i = 0; i < tabcontent.length; i++) {
    tabcontent[i].style.display = 'none';
  }

  // Récupère tous les éléments avec la classe "tablinks" et supprime la classe "active"
  const tablinks = document.getElementsByClassName('tablinks');
  for (let i = 0; i < tablinks.length; i++) {
    tablinks[i].classList.remove('active');
  }

  // Affiche l'onglet sélectionné et ajoute la classe "active" au bouton de l'onglet sélectionné
  document.getElementById(tabName).style.display = 'block';
  event.currentTarget.classList.add('active');
}

// Événement pour ouvrir la fenêtre modale
document.getElementById('openModalBtn').addEventListener('click', () => {
  document.getElementById('myModal').style.display = 'block';
});

// Événement pour fermer la fenêtre modale
document.querySelector('.close').addEventListener('click', () => {
  document.getElementById('myModal').style.display = 'none';
});

// Événement pour fermer la fenêtre modale en cliquant en dehors de celle-ci
window.addEventListener('click', (event) => {
  if (event.target === document.getElementById('myModal')) {
    document.getElementById('myModal').style.display = 'none';
  }
});
//------------------------------------------Option--------------------------------------------------------------------------------
//Mise en page
//-----------------------------------------oriantation-------------------------------------
function changeOrientationAndPaperSize() {
  const selectedOrientation = document.querySelector('input[name="orientation"]:checked').value;
  const selectedPaperSize = document.getElementById('paper-size').value;
  const editor = document.getElementById('editor');
  
  switch (selectedPaperSize) {
    case 'A4':
      if (selectedOrientation === 'portrait') {
        editor.style.width = '210mm';
        editor.style.height = '297mm';
      } else if (selectedOrientation === 'landscape') {
        editor.style.width = '297mm';
        editor.style.height = '210mm';
      }
      break;
    case 'A5':
      if (selectedOrientation === 'portrait') {
        editor.style.width = '148mm';
        editor.style.height = '210mm';
      } else if (selectedOrientation === 'landscape') {
        editor.style.width = '210mm';
        editor.style.height = '148mm';
      }
      break;
    case 'Letter':
      if (selectedOrientation === 'portrait') {
        editor.style.width = '8.5in';
        editor.style.height = '11in';
      } else if (selectedOrientation === 'landscape') {
        editor.style.width = '11in';
        editor.style.height = '8.5in';
      }
      break;
    case 'Legal':
      if (selectedOrientation === 'portrait') {
        editor.style.width = '8.5in';
        editor.style.height = '14in';
      } else if (selectedOrientation === 'landscape') {
        editor.style.width = '14in';
        editor.style.height = '8.5in';
      }
      break;
    // Ajoutez d'autres cas pour d'autres formats de papier si nécessaire
    default:
      break;
  }
}

// Événement pour détecter le changement d'orientation et de format de papier
document.querySelectorAll('input[name="orientation"], #paper-size').forEach((input) => {
  input.addEventListener('change', changeOrientationAndPaperSize);
});
//----------------------------------------------Taille--------------------------------------
// Fonction pour détecter le changement de format de papier et ajuster la taille de la zone de texte éditable en conséquence
function changePaperSize() {
  const selectedPaperSize = document.getElementById('paper-size').value;
  const editor = document.getElementById('editor');
  
  switch (selectedPaperSize) {
    case 'A4':
      editor.style.width = '210mm';
      editor.style.height = '297mm';
      break;
    case 'A5':
      editor.style.width = '148mm';
      editor.style.height = '210mm';
      break;
    case 'Letter':
      editor.style.width = '8.5in';
      editor.style.height = '11in';
      break;
    case 'Legal':
      editor.style.width = '8.5in';
      editor.style.height = '14in';
      break;
    // Ajoutez d'autres cas pour d'autres formats de papier si nécessaire
    default:
      break;
  }
}

// Événement pour détecter le changement de format de papier
document.getElementById('paper-size').addEventListener('change', changePaperSize);
//---------------------------------------------marge-----------------------------------------
// Fonction pour détecter le changement de marges et ajuster la taille de la zone de texte éditable en conséquence
function changeMarginSize() {
  const selectedMarginSize = document.getElementById('margin-size').value;
  const editor = document.getElementById('editor');
  
  switch (selectedMarginSize) {
    case 'narrow':
      editor.style.padding = '10mm';
      break;
    case 'normal':
      editor.style.padding = '20mm';
      break;
    case 'wide':
      editor.style.padding = '30mm';
      break;
    // Ajoutez d'autres cas pour d'autres options de marges si nécessaire
    default:
      break;
  }
}

// Événement pour détecter le changement de marges
document.getElementById('margin-size').addEventListener('change', changeMarginSize);
//-----------------------------------------------Tableau----------------------------------------------
// Sélectionnez le bouton d'insertion de tableau
const insertTableButton = document.getElementById('insert-table-btn');

// Ajoutez un écouteur d'événements pour l'insertion de tableau
insertTableButton.addEventListener('click', () => {
    // Récupérez le nombre de lignes et de colonnes à partir des champs d'entrée
    const numRows = parseInt(document.getElementById('num-rows').value);
    const numCols = parseInt(document.getElementById('num-cols').value);

    // Générez le code HTML pour le tableau en fonction du nombre de lignes et de colonnes
    let tableHtml = '<table border="1">';
    for (let i = 0; i < numRows; i++) {
        tableHtml += '<tr>';
        for (let j = 0; j < numCols; j++) {
            tableHtml += '<td>Donnée</td>';
        }
        tableHtml += '</tr>';
    }
    tableHtml += '</table>';

    // Insérez le tableau dans l'éditeur
    document.getElementById('editor').insertAdjacentHTML('beforeend', tableHtml);
});
//---------------------------------------------------------Image-----------------------------------------------
// Sélectionnez la zone de texte éditable
const imageInput = document.getElementById('image-input');

// Ajoutez un écouteur d'événements pour détecter la sélection d'un fichier image
imageInput.addEventListener('change', () => {
    const file = imageInput.files[0]; // Obtenez le fichier image sélectionné
    const reader = new FileReader(); // Créez un objet FileReader pour lire le contenu du fichier

    reader.onload = function(event) {
        const imageUrl = event.target.result; // Obtenez l'URL de l'image chargée

        // Insérez l'image dans l'éditeur à l'emplacement du curseur
        const imageHtml = `<img src="${imageUrl}" alt="Image">`;
        editor.focus(); // Assurez-vous que l'éditeur est sélectionné
        document.execCommand('insertHTML', false, imageHtml); // Insérez l'image dans l'éditeur
    };

    reader.readAsDataURL(file); // Lire le contenu du fichier sous forme d'URL de données
});
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>
  <script>
    //-------------------------------------------------------GEN PDF------------------------------------------
    document.getElementById('generatePdfBtn').addEventListener('click', () => {
      const editorContent = document.getElementById('editor').innerHTML;

      // Récupérer la taille du format sélectionnée
      const paperSize = document.getElementById('paper-size').value;
      
      // Récupérer l'orientation sélectionnée
      const orientation = document.querySelector('input[name="orientation"]:checked').value;

      // Options pour html2pdf
      const options = {
  filename: 'document.pdf',
  image: { type: 'png' }, // Utiliser le format PNG
  html2canvas: { scale: 2 },
  jsPDF: { unit: 'mm', format: paperSize, orientation: orientation }
};


      // Générer le PDF
      html2pdf().from(editorContent).set(options).save();
    });
  </script>
</body>
</html>