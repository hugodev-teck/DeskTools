<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <link rel="icon" href="Res/fichier-2.svg" type="image/x-icon">  
<title>Nouveau bloc note - DeskWritter</title>
  <style>
    body, html {
      margin: 0;
      padding: 0;
      height: 100%;
      background-color: rgb(255, 255, 255);
      overflow: hidden;
    }
    #top-bar {
      background: linear-gradient(to top, #F0F0F0, #d8d8d8);
      height: 48px;
      display: flex;
      justify-content: flex-start;
      align-items: center;
      padding-left: 10px;
      border-bottom-left-radius: 20px;
      border-bottom-right-radius: 20px;
      touch-action: manipulation;
      overflow: hidden;
    }
    #tool-contener-line1 {
        display: flex;
      justify-content: flex-start;
      align-items: center;
      
    }
    #tool-contener-line2 {
        display: flex;
      justify-content: flex-start;
      align-items: center;
    }
    #middle-bar {
      background-color: rgb(255, 255, 255);
      padding: 10px;
      overflow-x: scroll;
      overflow-y: hidden;
      display: flex;
    align-items: center; /* Alignement vertical au centre si nécessaire */
    }
    #middle-bar::-webkit-scrollbar {
  height: 5px; /* Largeur de la barre de défilement */
}

/* Style de la poignée de la barre de défilement */
#middle-bar::-webkit-scrollbar-thumb {
  background-color: rgba(179, 179, 179, 0.5); /* Couleur de la poignée */
  border-radius: 5px; /* Bord arrondi de la poignée */
}

/* Style de la piste de la barre de défilement (la piste est la partie de la barre de défilement où se déplace la poignée) */
#middle-bar::-webkit-scrollbar-track {
  background-color: transparent; /* Fond de la piste transparent */
}

/* Masquer les flèches de défilement */
#middle-bar::-webkit-scrollbar-button {
  display: none; /* Masquer les flèches de défilement */
}

/* Masquer les coins de défilement */
#middle-bar::-webkit-scrollbar-corner {
  background-color: transparent; /* Fond des coins transparent */
}
    #content {
      background: linear-gradient(to bottom, #F0F0F0, #d8d8d8);
      height: 82%;
      border-top-right-radius: 20px;
      border-top-left-radius: 20px;
      width: 100%;
      z-index: 9999;
      touch-action: manipulation;
      overflow: auto;
    }
    .button-with-image {
      height: 45px;
      width: 45px;
      background-color: transparent;
      border-color: transparent;
      cursor: pointer;
      display: inline-block;
      margin-right: 10px;
    }
    .button-with-image img {
      height: 30px;
      width: 30px;
    }
    .class1-button {
      height: 40px;
      width: 40px;
      background-color: transparent;
      border-color: transparent;
      cursor: pointer;
      display: inline-block;
      height: 40px;
    }
    .class1-button img {
      height: 20px;
      width: 20px;
    }
    #tool-container-text {
        background-color: white;
        width: 270px;
        height: 40px;
        border-radius: 50px;
        margin-top: 10px;
        margin-left: 10px;
        box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.253);
    }
    .class2-button {
      height: 40px;
      width: 40px;
      background-color: transparent;
      border-color: transparent;
      cursor: pointer;
      display: inline-block;
      margin-left: 5px;
    }
    .class2-button img {
      height: 20px;
      width: 20px;
    }
    #tool-container-text-adv {
        background-color: white;
        width: 153px;
        border-radius: 50px;
        margin-top: 10px;
        margin-left: 10px;
        box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.253);
    }
    #font-family {
        background-color: white;
        width: 200px;
        border-radius: 50px;
        margin-top: 10px;
        margin-left: 10px;
        height: 40px;
        border-color: transparent;
        text-align: center;
        box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.253);
    }
    #font-size {
        background-color: white;
        width: 80px;
        border-radius: 50px;
        margin-top: 10px;
        margin-left: 10px;
        height: 40px;
        border-color: transparent;
        text-align: center;
        box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.253);
    }
    #editor {
            background-color: #ffffff;
            border: 30px solid #ffffff;
            padding: 15px;
            font-family: Arial, sans-serif;
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.253);
            border-radius: 5px;
            width: 210mm;
            height: 297mm;
            margin-top: 50px;
            margin-left: 50%;
            margin-bottom: 25px;
            transform: translateX(-50%);
            overflow: hidden;
            
        }
      .class2-button-solo {
      height: 40px;
      width: 40px;
      margin-top: 15px;
      background-color: transparent;
      border-color: transparent;
      cursor: pointer;
      display: inline-block;
    }
    .class2-button-solo img {
      height: 20px;
      width: 20px;
    }
    #apply-stand {
      margin-left: 12px;
    }
    #apply-stand-new-line {
      margin-left: 6px;
    }
    #tool-container-color {
      background-color: white;
      width: 310px;
      border-radius: 50px;
      margin-top: 10px;
      margin-left: 10px;
      box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.253);
      padding: 7.5px;
    }
    .class1-color-button {
      height: 25px;
      width: 25px;
      margin-left: 5px;
      border-radius: 50px;
      box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.253);
      border-color: transparent;
    }
    #black {
      background-color: black;
    }
    #red {
      background-color: rgb(202, 48, 48);
    }
    #orange {
      background-color: rgb(243, 162, 10);
    }
    #yellow {
      background-color: rgb(235, 235, 0);
    }
    #green {
      background-color: rgb(0, 134, 0);
    }
    #bluef {
      background-color: rgb(18, 18, 131);
    }
    #bluec {
      background-color: rgb(20, 141, 172);
    }
    #pink {
      background-color: pink;
    }
    #another {
      background: radial-gradient(circle, rgb(7, 165, 177), rgb(191, 219, 159), rgb(201, 223, 7));
    }
    #zoom-contener {
      background-color: rgba(255, 255, 255, 0.507);
      width: 300px;
      border-radius: 50px;
      margin-top: 10px;
      margin-left: 10px;
      box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.253);
      padding: 7.5px;
      height: 30px;
      position: absolute;
      bottom: 10px;
      right: 35px;
      z-index: 9999;
    }
    .barre-zoom {
      position: absolute;
      width: 60%;
      left: 55px;
      top: 13px;
    }

    #valeur-zoom {
      position: absolute;
      top: 14px;
      right: 13px;
    }
    #zoom-image {
      position: absolute;
      top: 13px;
      left: 20px;
      height: 20px;
      width: 20px;
      opacity: 0.5;
    }
    #loader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #ffffff;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 99999;
        }

        #loader img {
            width: 15%;
        }

        .bottom-content {
            text-align: center;
            margin: 20px 0;
            position: absolute;
            bottom: 0;
        }
        
.container h1 {
            text-align: center;
            font-size: 160%;
        }
        .container h2 {
          margin-top: -10px;
            text-align: center;
            font-size: 100%;
        }
        .container input {
            width: 95%;
            padding: 10px;
            margin-bottom: 10px;
            border: none;
            background: #eee;
            margin-top: 5%;
        }

        .container button {
            width: 30%;
            padding: 10px;
            border: none;
            background: #ff3333;
            color: white;
            cursor: pointer;
        }

        .container a {
            color: rgb(0, 0, 0);
            text-decoration: underline;
            cursor: pointer;
            border: none;
        }
        #createaccnt {
          width: 50%;
            padding: 10px;
            border: none;
            color: #ff3333;
            background-color: transparent;
            cursor: pointer;
            text-align: left;
        }
        .buttons-container {
    display: flex;
    justify-content: space-between; /* Alignement horizontal au centre */
    align-items: center; /* Alignement vertical au centre si nécessaire */
    margin-top: 10%;
    margin-bottom: 5%;
}
#image_logo {
    margin-left: 50%;
    transform: translateX(-50%);
}
#emailDisplayAt2 {
    text-align: center;
}
#emailText {
    color: rgb(204, 204, 204);
    text-align: left;
    font-size: 12px;
}
#tool-container-text-b {
        background-color: white;
        width: 90px;
        height: 40px;
        padding-left: 5px;
        border-radius: 50px;
        margin-top: 10px;
        margin-left: 10px;
        box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.253);
    }
    #menu {
      display: flex;
      align-items: center; /* Alignement vertical au centre si nécessaire */
      flex-direction: row;
            position: fixed;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: #fff;
            transition: left 0.8s;
            z-index: 9999999;
        }
    #emailDisplay {
      background-color: rgb(216, 216, 216);
      display: flex;
      flex-direction: column;
    align-items: center; /* Alignement vertical au centre si nécessaire */
    margin-top: 0px;
    margin-left: 0px;
    width: 19%;
    height: 100%;
    }
        /* Style pour la fenêtre modale */
.modal {
  display: none; /* Par défaut, la fenêtre modale est cachée */
  position: fixed;
  z-index: 1;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  overflow: auto;
  background-color: rgba(0,0,0,0.5); /* Fond semi-transparent */
}

/* Contenu de la fenêtre modale */
.modal-content {
  background-color: #fefefe;
  margin: 15% auto;
  padding: 20px;
  border: 1px solid #888;
  width: 50%; /* Largeur de la fenêtre modale */
  height: 50%;
}

/* Style pour le bouton de fermeture */
.close {
  color: #aaa;
  float: right;
  font-size: 28px;
  font-weight: bold;
}

.close:hover,
.close:focus {
  color: black;
  text-decoration: none;
  cursor: pointer;
}
.closebtn {
  color: #aaa;
  float: right;
  font-size: 28px;
  font-weight: bold;
}

.closebtn:hover,
.closebtn:focus {
  color: rgb(155, 32, 32);
  text-decoration: none;
  cursor: pointer;
}
/* Ajoutez du style pour les onglets et le contenu des onglets */
.tabcontent {
  display: none;
}

/* Style actif pour les onglets */
.tabcontent.active {
  display: block;
}

/* Style pour les boutons des onglets */
.tablinks {
  background-color: #f2f2f2;
  border: none;
  cursor: pointer;
  padding: 10px 20px;
}

.tablinks:hover {
  background-color: #ddd;
}
@keyframes grow {
  0% {
    transform: scale(0.4);
  }
  100% {
    transform: scale(1);
  }
}
.imgloaderorg {
  animation: grow 2s ease-in-out forwards;
}
table {
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid black;
            padding: 8px;
            resize: both; /* Permet le redimensionnement */
            overflow: auto; /* Affiche les barres de défilement si nécessaire */
        }

        img {
            max-width: 100%;
            height: auto;
            resize: both;
            border: 2px solid transparent; /* Ajoute une bordure pour indiquer que l'image est redimensionnable */
        }
        #editor img {
            max-width: 100%;
            height: auto;
            border: 2px solid transparent; /* Ajoute une bordure pour indiquer que l'image est redimensionnable */
            position: absolute; /* Permet le positionnement absolu */
            user-select: none; /* Empêche la sélection du texte lors du déplacement de l'image */
            cursor: grab; /* Curseur indiquant que l'image peut être déplacée */
        }
        /* Styles for custom context menu */
        #custom-menu {
      display: none;
      position: absolute;
      background-color: #fff;
      border: 1px solid #ccc;
      padding: 8px;
      box-shadow: 0px 2px 6px rgba(0,0,0,0.1);
      min-width: 200px;
      border-radius: 10px;
      z-index: 99999;
    }
    #custom-menu ul {
      list-style-type: none;
      margin: 0;
      padding: 0;
    }
    #custom-menu li {
      display: flex; /* Utiliser flexbox pour aligner les éléments horizontalement */
      align-items: center; /* Aligner les éléments verticalement */
      padding: 8px 20px;
      cursor: pointer;
    }
    #custom-menu ul li:hover {
      background-color: #f0f0f0;
    }
    /* Styles for icons */
    .icon {
      width: 20px; /* Adjust as needed */
      height: 20px; /* Adjust as needed */
      margin-right: 8px;
    }
    /* Styles for search bar */
    #search-bar {
      width: calc(100% - 20px); /* Adjust for padding */
      padding: 8px;
      margin-bottom: 8px;
      border-radius: 5px;
      border-style: solid;
      border-color: gray;
    }
    /* Styles pour l'élément imprprev (modal d'aperçu avant impression) */
#imprprev {
  display: none;
  position: fixed;
  z-index: 1000;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  overflow: auto;
  background-color: rgba(0, 0, 0, 0.5); /* Fond semi-transparent */
}

#imprprev .modal-content {
  background-color: #fefefe;
  margin: 15% auto;
  padding: 20px;
  border: 1px solid #888;
  border-radius: 10px;
  width: 80%;
  height: 52%;
  max-width: 600px;
}

#imprprev .close {
  color: #aaa;
  float: right;
  font-size: 28px;
  font-weight: bold;
}

#imprprev .close:hover,
#imprprev .close:focus {
  color: black;
  text-decoration: none;
  cursor: pointer;
}

/* Styles pour le bouton d'aperçu avant impression */
#print-preview-btn {
  background-color: #4CAF50; /* Couleur de fond */
  border: none;
  color: white;
  padding: 10px 20px;
  text-align: center;
  text-decoration: none;
  display: inline-block;
  font-size: 16px;
  margin-bottom: 10px;
  cursor: pointer;
  border-radius: 5px;
}

#print-preview-btn:hover {
  background-color: #45a049; /* Changement de couleur au survol */
}

/* Styles pour le bouton d'impression */
#print-btn {
  background-color: #008CBA; /* Couleur de fond */
  border: none;
  color: white;
  padding: 10px 20px;
  text-align: center;
  text-decoration: none;
  display: inline-block;
  font-size: 16px;
  margin-top: 10px;
  cursor: pointer;
  border-radius: 5px;
}

#print-btn:hover {
  background-color: #0073a8; /* Changement de couleur au survol */
}
#zone2-tool-bar-top-line1-bis {
  margin-top: 5px;
  margin-left: 20px;
  display: flex;
    align-items: center; /* Alignement vertical au centre si nécessaire */
}
#zone1-tool-bar-top-line1-line2 {
  margin-top: -7px;
}
.soussection {
  
  background-color: white;
        align-items: center;
        height: 75px;
        width: 120px;
        padding-left: 5px;
        border-color: rgb(231, 231, 231);
        border-style: solid;
        border-radius: 10px;
        margin-left: 10px;
        cursor: pointer;
  transition: background-color 0.3s ease; /* Ajoute une transition de couleur sur 0.3s */
}
.soussection:hover {
  background-color: #f0f0f0; /* Change la couleur de fond au survol */
}
#tool-container-text-c {
  display: flex;
    align-items: center; /* Alignement vertical au centre si nécessaire */
        background-color: white;
        padding-right: 20px;
        height: 100px;
        padding-left: 5px;
        border-radius: 10px;
        margin-bottom: 5px;
        margin-left: 10px;
        box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.253);
    }
    #tool-container-micro {
        background-color: white;
        height: 100px;
        padding-left: 6px;
        border-color: transparent;
        border-radius: 10px;
        margin-bottom: 5px;
        margin-left: 13px;
        box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.253);
        transition: background-color 0.3s ease; /* Ajoute une transition de couleur sur 0.3s */
    }
    #tool-container-micro:hover {
  background-color: #f0f0f0; /* Change la couleur de fond au survol */
}
    #tool-container-micro img {
      width: 30px;
      height: 30px;
      margin-top: 15px;
    }
    #tool-container-micro h1 {
      font-size: small;
      font-family: sans-serif;
      padding: 5px;
      color: #757575;
}
    #soustitre h1{
      font-size: 19px;
      font-family: Arial;
      color: rgb(48, 48, 48);
    }
    #titre1 h1{
      font-size: 20px;
      font-family: Arial;
      color: rgb(18, 18, 131);
      font-style: italic;
    }
    #titre2 h1{
      font-size: 20px;
      font-family: sans-serif;
      color: rgb(252, 193, 0);
      font-style: italic;
    }
    #titre3 h1{
      font-size: 18px;
      font-family: sans-serif;
      color: rgb(61, 61, 61);
      font-style: italic;
    }
    #citation h1{
      font-size: 17px;
      font-family: Arial;
      color: gray;
      font-style: italic;

    }
    #soustitre h2{
      font-size: 10px;
      font-family: Arial;
      color: rgb(180, 180, 180);
      font-style: italic;

}
#titre1 h2{
  font-size: 10px;
      font-family: Arial;
      color: rgb(180, 180, 180);
      font-style: italic;

}
#titre2 h2{
  font-size: 10px;
      font-family: Arial;
      color: rgb(180, 180, 180);
      font-style: italic;

}
#titre3 h2{
  font-size: 10px;
      font-family: Arial;
      color: rgb(180, 180, 180);
      font-style: italic;

}
#citation h2{
  font-size: 10px;
      font-family: Arial;
      color: rgb(180, 180, 180);
      font-style: italic;

}
#sansinterligna h1 {
      font-size: 16px;
      font-family: Arial;
      color: rgb(27, 27, 27);
      font-style: italic;

}
#sansinterligna h2 {
  font-size: 10px;
      font-family: Arial;
      color: rgb(180, 180, 180);
      font-style: italic;
}
.menubtnm {
  display: flex;
  align-items: center; /* Alignement vertical au centre si nécessaire */
  text-align: center;
  width: 100%;
  height: 40px;
  transition: background-color 0.3s ease;
  background-color: transparent;
  border-color: transparent;
  margin-left: 25px;
}
.menubtnm img {
  width: 25px;
  height: auto;
}
.menubtnm h1 {
  font-size: small;
  margin-left: 15px;
}
.menubtnm:hover {
  text-decoration: underline;
}
#textinpunmenu {
  padding-inline-start: 10px;
  width: 80%;
  border-radius: 50px;
  border-color: transparent;
  height: 30px;
  margin-top: 15px;
  margin-bottom: 20px;
  box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.253);
}
#infomodel {
  height: 100%;
  width: 81%;
  background-color: #f7f7f7;
}
#start {
        background-color: #4a6c7e96;
        color: #fff;
        padding: 10px;
        width: 100%;
        box-sizing: border-box;
        height: 420px;
        overflow-x: scroll;
    }
    .content {
        flex: 1;
        margin-left: 100px; /* Pour laisser de la place à la sidebar */
    }
    #list {
        height: 600px;
        width: 100%;
        background-color: #dbdbdb;
    }
    .template {
            width: 180px; /* Ajustez la largeur selon vos besoins */
            border-radius: 10px;
            background: #ececec8e; /* Fond blanc */
            color: black;
            padding: 20px;
            text-align: center;
            margin-left: 50px;
            align-items: center;
            margin-top: 20px;
        }

        .template img {
            width: 70%; /* Ajustez la taille de l'image selon vos besoins */
            border-radius: 10px;
        }

        .logo {
            background: #8888888c; /* Fond gris */
            width: 100%; /* Ajustez la taille de la case grise */
            height: 50px; /* Ajustez la taille de la case grise */
            display: flex;
            justify-content: center;
            overflow: hidden;
            align-items: center;
            border-radius: 10px;
            margin-top: 9px; /* Marge pour l'espacement */
        }
        .logooth {
            background: rgba(255, 255, 255, 0.438); /* Fond gris */
            width: 50px; /* Ajustez la taille de la case grise */
            height: 50px; /* Ajustez la taille de la case grise */
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 10px;
            margin-top: 9px; /* Marge pour l'espacement */
            margin-left: 25px;
        }
        #logomenu {
            width: 35px; /* Ajustez la taille de la case grise */
            height: 35px; /* Ajustez la taille de la case grise */
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 10px;
            margin-top: 9px; /* Marge pour l'espacement */
            margin-top: 30px;
            margin-left: 33px;
            margin-bottom: 40px;
        }
        .logooth img {
            width: 70%;
            height: 70%;
        }
        .logo img {
            width: 30px; /* Ajustez la taille du logo à l'intérieur de la case grise */
        }
        .logo p {
            margin-left: 7px;
        }
        .carousel {
          display: flex;
          align-items: center; /* Alignement horizontal au centre */
        }
        #infomodel h1 {
          margin-left: 25px;
          font-size: x-large;
          font-family: sans-serif;
          
        }
        #tool-container-micro-act {
        position: fixed;
        z-index: 1000;
        left: 200px;
        top: 200px;
        background-color: rgba(0, 0, 0, 0.5);
        background-color: white;
        height: 100px;
        width: 100px;
        padding-left: 6px;
        border-color: transparent;
        border-radius: 10px;
        margin-bottom: 5px;
        margin-left: 13px;
        box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.253);
        transition: background-color 0.3s ease;
        display: none;
        overflow: hidden;
    }
    #tool-container-micro-act h1 {
      font-size: 12px;
      font-family: sans-serif;
    }
    #tool-container-micro-act button {
      border-color: transparent;
      background-color: transparent;
    }
    #tool-container-micro-act img {
      width: 50px;
      height: auto;
      margin-top: 5px;
      margin-left: 10px;
    }
    #microphoneIcon {
  border-radius: 50%;
}
#tool-container-sc {
        background-color: white;
        height: 100px;
        padding-left: 6px;
        border-color: transparent;
        border-radius: 10px;
        margin-bottom: 5px;
        margin-left: 13px;
        box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.253);
        transition: background-color 0.3s ease; /* Ajoute une transition de couleur sur 0.3s */
    }
    #tool-container-sc:hover {
  background-color: #f0f0f0; /* Change la couleur de fond au survol */
}
    #tool-container-sc img {
      width: 30px;
      height: 30px;
      margin-top: 15px;
    }
    #tool-container-sc h1 {
      font-size: small;
      font-family: sans-serif;
      color: #757575;
      margin-top: 5px;
}
#tool-container-sc h1:last-child {
      margin-top: -8px;
}
#special-characters-container {
  position: fixed;
  z-index: 9999;
  right: 30px;
  width: 210px;
  height: 210px;
  top: 175px;
  display: none;
  border-radius: 10px;
  flex-wrap: wrap; /* Permettre le retour à la ligne des boutons si nécessaire */
  background-color: #aaaaaa;
  overflow-y: scroll;
}
#special-characters-container h1 {
  font-size: small;
  color: rgb(46, 46, 46);
}

.special-character {
  margin: 3px; /* Espacement entre les boutons */
  padding: 5px 10px; /* Espacement interne des boutons */
  font-size: 16px; /* Taille de la police */
  border: 1px solid #ccc; /* Bordure autour des boutons */
  border-radius: 5px; /* Coins arrondis */
  background-color: #808080; /* Couleur de fond */
  cursor: pointer; /* Curseur de la souris */
  width: 40px;
  height: 40px;
  transition: background-color 0.3s; /* Transition pour un changement de couleur en douceur */
}

.special-character:hover {
  background-color: #e0e0e0; /* Couleur de fond au survol */
}
/* Style de la div modal */
.genema {
    position: fixed;
    bottom: 65px;
    right: 50px;
    min-width: 300px;
    width: 12%;
    height: 60%;
    background-color: #f4f4f4;
    box-shadow: -2px 0 5px rgba(0, 0, 0, 0.1);
    padding: 20px;
    z-index: 100;
    overflow: hidden;
    display: flex;
    flex-direction: column;
}

/* Style de la barre en-tête */
#barre-gen {
    height: 38px;
    width: 100%;
    display: flex;
    align-items: center; /* aligne les éléments verticalement */
}

#barre-gen img {
    height: 38px;
    width: 38px;
}

#barre-gen h2 {
    font-family: sans-serif;
    font-size: 23px;
    margin-left: 10px;
}

/* Style pour #output */
#output {
    flex-grow: 1; /* Permet à #output de prendre toute la place restante */
    margin: 10px 0; /* Espacement autour de #output */
    margin-bottom: 50px;
    overflow-y: auto; /* Ajoute un défilement si le contenu dépasse */
    height: 100%;
}

/* Style pour le bouton */
#correct {
    position: absolute;
    bottom: 20px;
    width: 90%;
    height: 35px;
    border-radius: 10px;
    cursor: pointer;
    border: none;
    color: black;
    background-color: #00b0b390;
}

  </style>
</head>
<body>
  <div id="loader">
    <img class="imgloaderorg" src="Res/fichier-2.svg">
    <div class="bottom-content">
        <img src="Res/logo-text-big.png">
    </div> 
</div>
<div id="tool-container-micro-act">
  <h1 id="titled">Enregistrement</h1>
  <button onclick="stopSpeechRecognition()"><img id="microphoneIcon" src="Res/stop-button.png" alt="stoprec"></button>
</div>
<div id="imprprev">
  <div class="modal-content">
    <span class="close" onclick="closePrintPreviewModal()">&times;</span>
    <h2>Paramètre</h2>
    <h3>Mise en page</h3>
      <h4>Orientation de la page :</h4>
      <label><input type="radio" name="orientation" value="portrait" checked> Portrait</label>
      <label><input type="radio" name="orientation" value="landscape"> Paysage</label>
      <p>Le type de feuille est actuellement 'A4'</p>
      <h4>Format de papier :</h4>
      <select id="paper-size-bis">
        <option value="A4">A4</option>
        <option value="A5">A5</option>
        <option value="Letter">Lettre US</option>
        <option value="Legal">Legal US</option>
      </select>
      <h4>Marges :</h4>
      <select id="margin-size-bis">
        <option value="no">Aucune marge</option>
        <option value="narrow">Étroite (marge de 10mm)</option>
        <option value="normal" selected>Normale (marge de 20mm)</option>
        <option value="wide">Large (marge de 30mm)</option>
        <!-- Ajoutez d'autres options de marges si nécessaire -->
      </select>
      <ul>
        <li><strong>Étroite :</strong> Une marge de 10 mm.</li>
        <li><strong>Normale :</strong> Une marge de 20 mm.</li>
        <li><strong>Large :</strong> Une marge de 30 mm.</li>
      </ul>
    <button id="print-btn" onclick="printContent()">Imprimer</button>
  </div>
</div>
<div id="custom-menu">
  <input type="text" id="search-bar" placeholder="Search..."> <!-- Search bar -->
  <ul>
    <li id="menucut"><img src="Res/scissors.png" alt="Icon 1" class="icon"> Couper</li>
    <li id="menucopy"><img src="Res/copy.png" alt="Icon 1" class="icon"> Copier</li>
    <li id="menupast"><img src="Res/paste.png" alt="Icon 2" class="icon"> Coller</li>
    <li id="openModalinster"><img src="Res/image.png" alt="Icon 2" class="icon"> Inserer</li>
    <li id="openModalpara"><img src="Res/setting.png" alt="Icon 2" class="icon"> Paramètre page</li>
    <li><img src="Res/link.png" alt="Icon 2" class="icon"> Lien</li>
    <li><img src="Res/question.png" alt="Icon 2" class="icon"> Aide en ligne</li>
    <li id="GenemaPara"><img src="Res/GENEMA-logo.png" alt="Icon 2" class="icon"> Ouvrir GENEMA</li>
  </ul>
</div>
  <div id="top-bar">
    <button class="button-with-image" id="menudev"><img src="Res/applications.png" alt="Image 1"></button>
    <button id="save" class="button-with-image"><img src="Res/save.png" alt="Image 2"></button>
    <button id="open" class="button-with-image"><img src="Res/open.png" alt="Image 4"></button>
    <input type="file" id="file-input" style="display: none;">
    <button class="button-with-image" id="openModalBtn"><img src="Res/settings-sliders.png" alt="Image 3"></button>
    <button class="button-with-image" onclick="openPopup()"><img src="Res/profile-user.png" alt="connexion au service"></button>
    <div id="menu" class="hidden" style="left: -100%;">
      <div id="emailDisplay">
          <input placeholder="Recherche ici..." id="textinpunmenu" type="text"></input>
          <button class="menubtnm" id="menu-return-button" onclick="window.location.href = 'index.html';">
            <img src="Res/home.png" alt="arrow">
            <h1>Accueil</h1>
          </button>
          <button class="menubtnm" id="save">
            <img src="Res/save.png" alt="arrow">
            <h1>Ouvrir</h1>
          </button>
          <button class="menubtnm" id="open">
            <img src="Res/open.png" alt="arrow">
            <h1>Sauvegarder</h1>
          </button>
          <button class="menubtnm" id="Conn-btn" onclick="openPopup(); toggleMenu();">
            <img src="Res/profile-user.png" alt="arrow">
            <h1>Connection à PRISMID</h1>
          </button>
          <button class="menubtnm" id="closebtn" onclick="toggleMenu();">
            <img src="Res/arrow.png" alt="arrow">
            <h1>Retour</h1>
          </button>
      </div>
      <div id="infomodel">
        <h1>Créer un nouveau document :</h1>
        <div id="start">
          <div class="carousel">
          <div class="template">
              <img id="to-writter" src="Res/page.png" alt="Image du Template">
              <p>Fichier texte vide</p>
              <div class="logo">
                  <img id="to-writter" src="Res/fichier (2).png" alt="Logo">
                  <p>DeskWritter</p>
              </div>
          </div>
          <div class="template" onclick="openmedel('lettre'); toggleMenu();">
            <img id="to-writter" src="Res/pagelettre.png" alt="Image du Template">
            <p>Lettre simple</p>
            <div class="logo">
                <img id="to-writter" src="Res/fichier (2).png" alt="Logo">
                <p>DeskWritter</p>
            </div>
        </div>
        <div class="template" onclick="openmedel('liste'); toggleMenu();">
          <img id="to-writter" src="Res/pageliste.png" alt="Image du Template">
          <p>Liste simple</p>
          <div class="logo">
              <img id="to-writter" src="Res/fichier (2).png" alt="Logo">
              <p>DeskWritter</p>
          </div>
      </div>
      <div class="template" onclick="openmedel('PV'); toggleMenu();">
        <img id="to-writter" src="Res/pagepv.png" alt="Image du Template">
        <p>Procès-verbal de réunion</p>
        <div class="logo">
            <img id="to-writter" src="Res/fichier (2).png" alt="Logo">
            <p>DeskWritter</p>
        </div>
    </div>
    <div class="template" onclick="openmedel('rapport'); toggleMenu();">
      <img id="to-writter" src="Res/pagerapport.png" alt="Image du Template">
      <p>Rapport simple</p>
      <div class="logo">
          <img id="to-writter" src="Res/fichier (2).png" alt="Logo">
          <p>DeskWritter</p>
      </div>
  </div>
      </div>
      </div>
      </div>
      
  </div>

</div>
<div id="middle-bar">
<div id="zone1-tool-bar-top-line1-line2">
<div id="tool-contener-line1">
    <div id="tool-container-text-adv">
        <button class="class2-button"><img src="Res/copy.png" alt="img"></button>
        <button class="class2-button"><img src="Res/paste.png" alt="img"></button>
        <button class="class2-button"><img src="Res/scissors.png" alt="img"></button>
    </div>
    <div id="tool-container-text-b">
      <button class="class1-button" ><img src="Res/undo.png" alt="img"></button>
      <button class="class1-button"><img src="Res/forward.png" alt="img"></button>
      
    </div>
    <select id="font-family">
    
    <option value="Agency FB">Agency FB</option>
    <option value="Algerian">Algerian</option>
    <option value="Andalus">Andalus</option>
    <option value="Arial Narrow">Arial Narrow</option>
    <option value="Arial Black">Arial Black</option>
    <option value="Arial Rounded MT Bold">Arial Rounded MT Bold</option>
    <option value="Bauhaus 93">Bauhaus 93</option>
    <option value="Bell MT">Bell MT</option>
    <option value="Berlin Sans FB">Berlin Sans FB</option>
    <option value="Bernard MT Condensed">Bernard MT Condensed</option>
    <option value="Blackadder ITC">Blackadder ITC</option>
    <option value="Bodoni MT">Bodoni MT</option>
    <option value="Bodoni MT Poster Compressed">Bodoni MT Poster Compressed</option>
    <option value="Bookshelf Symbol 7">Bookshelf Symbol 7</option>
    <option value="Bradley Hand ITC">Bradley Hand ITC</option>
    <option value="Broadway">Broadway</option>
    <option value="Brush Script MT">Brush Script MT</option>
    <option value="Bodoni MT">Bodoni MT</option>
    <option value="Bodoni MT Black">Bodoni MT Black</option>
    <option value="Bodoni MT Condensed">Bodoni MT Condensed</option>
    <option value="Bodoni MT Poster Compressed">Bodoni MT Poster Compressed</option>
    <option value="Book Antiqua">Book Antiqua</option>
    <option value="Bookman Old Style">Bookman Old Style</option>
    <option value="Bookshelf Symbol 7">Bookshelf Symbol 7</option>
    <option value="Bradley Hand ITC">Bradley Hand ITC</option>
    <option value="Britannic Bold">Britannic Bold</option>
    <option value="Broadway">Broadway</option>
    <option value="Brush Script MT">Brush Script MT</option>
    <option value="Bodoni MT">Bodoni MT</option>
    <option value="Bodoni MT Black">Bodoni MT Black</option>
    <option value="Bodoni MT Condensed">Bodoni MT Condensed</option>
    <option value="Bodoni MT Poster Compressed">Bodoni MT Poster Compressed</option>
    <option value="Book Antiqua">Book Antiqua</option>
    <option value="Bookman Old Style">Bookman Old Style</option>
    <option value="Bookshelf Symbol 7">Bookshelf Symbol 7</option>
    <option value="Bradley Hand ITC">Bradley Hand ITC</option>
    <option value="Britannic Bold">Britannic Bold</option>
    <option value="Broadway">Broadway</option>
    <option value="Brush Script MT">Brush Script MT</option>
    <option value="Californian FB">Californian FB</option>
    <option value="Calisto MT">Calisto MT</option>
    <option value="Cambria">Cambria</option>
    <option value="Candara">Candara</option>
    <option value="Castellar">Castellar</option>
    <option value="Centaur">Centaur</option>
    <option value="Century">Century</option>
    <option value="Century Gothic">Century Gothic</option>
    <option value="Century Schoolbook">Century Schoolbook</option>
    <option value="Chiller">Chiller</option>
    <option value="Colonna MT">Colonna MT</option>
    <option value="Comic Sans MS">Comic Sans MS</option>
    <option value="Consolas">Consolas</option>
    <option value="Constantia">Constantia</option>
    <option value="Cooper Black">Cooper Black</option>
    <option value="Copperplate Gothic Bold">Copperplate Gothic Bold</option>
    <option value="Copperplate Gothic Light">Copperplate Gothic Light</option>
    <option value="Corbel">Corbel</option>
    <option value="Cordia New">Cordia New</option>
    <option value="Courier New">Courier New</option>
    <option value="Courier Std">Courier Std</option>
    <option value="Curlz MT">Curlz MT</option>
    <option value="Curlz MT">Curlz MT</option>
    <option value="DejaVu Sans">DejaVu Sans</option>
    <option value="DejaVu Sans Condensed">DejaVu Sans Condensed</option>
    <option value="DejaVu Sans Light">DejaVu Sans Light</option>
    <option value="DejaVu Sans Mono">DejaVu Sans Mono</option>
    <option value="DejaVu Serif">DejaVu Serif</option>
    <option value="DejaVu Serif Condensed">DejaVu Serif Condensed</option>
    <option value="Dubai">Dubai</option>
    <option value="Dubai Light">Dubai Light</option>
    <option value="Dubai Medium">Dubai Medium</option>
    <option value="Dubai SemiBold">Dubai SemiBold</option>
    <option value="Dubai Bold">Dubai Bold</option>
    <option value="Elephant">Elephant</option>
    <option value="Engravers MT">Engravers MT</option>
    <option value="Eras Bold ITC">Eras Bold ITC</option>
    <option value="Eras Demi ITC">Eras Demi ITC</option>
    <option value="Eras Light ITC">Eras Light ITC</option>
    <option value="Eras Medium ITC">Eras Medium ITC</option>
    <option value="Eras Ultra ITC">Eras Ultra ITC</option>
    <option value="Felix Titling">Felix Titling</option>
    <option value="Footlight MT Light">Footlight MT Light</option>
    <option value="Forte">Forte</option>
    <option value="Franklin Gothic Book">Franklin Gothic Book</option>
    <option value="Franklin Gothic Demi">Franklin Gothic Demi</option>
    <option value="Franklin Gothic Demi Cond">Franklin Gothic Demi Cond</option>
    <option value="Franklin Gothic Heavy">Franklin Gothic Heavy</option>
    <option value="Franklin Gothic Medium">Franklin Gothic Medium</option>
    <option value="Franklin Gothic Medium Cond">Franklin Gothic Medium Cond</option>
    <option value="Freestyle Script">Freestyle Script</option>
    <option value="French Script MT">French Script MT</option>
    <option value="Gabriola">Gabriola</option>
    <option value="Garamond">Garamond</option>
    <option value="Gautami">Gautami</option>
    <option value="Gigi">Gigi</option>
    <option value="Gill Sans MT">Gill Sans MT</option>
    <option value="Gill Sans MT Condensed">Gill Sans MT Condensed</option>
    <option value="Gill Sans MT Ext Condensed Bold">Gill Sans MT Ext Condensed Bold</option>
    <option value="Gloucester MT Extra Condensed">Gloucester MT Extra Condensed</option>
    <option value="Goudy Old Style">Goudy Old Style</option>
    <option value="Goudy Stout">Goudy Stout</option>
    <option value="Gulim">Gulim</option>
    <option value="GulimChe">GulimChe</option>
    <option value="Haettenschweiler">Haettenschweiler</option>
    <option value="Harlow Solid Italic">Harlow Solid Italic</option>
    <option value="Harrington">Harrington</option>
    <option value="High Tower Text">High Tower Text</option>
    <option value="Impact">Impact</option>
    <option value="Imprint MT Shadow">Imprint MT Shadow</option>
    <option value="Informal Roman">Informal Roman</option>
    <option value="Javanese Text">Javanese Text</option>
    <option value="Jokerman">Jokerman</option>
    <option value="Juice ITC">Juice ITC</option>
    <option value="Kristen ITC">Kristen ITC</option>
    <option value="Kunstler Script">Kunstler Script</option>
    <option value="Leelawadee">Leelawadee</option>
    <option value="Leelawadee UI">Leelawadee UI</option>
    <option value="Lucida Bright">Lucida Bright</option>
    <option value="Lucida Calligraphy">Lucida Calligraphy</option>
    <option value="Lucida Console">Lucida Console</option>
    <option value="Lucida Fax">Lucida Fax</option>
    <option value="Lucida Handwriting">Lucida Handwriting</option>
    <option value="Lucida Sans">Lucida Sans</option>
    <option value="Lucida Sans Typewriter">Lucida Sans Typewriter</option>
    <option value="Lucida Sans Unicode">Lucida Sans Unicode</option>
    <option value="Magneto">Magneto</option>
    <option value="Maiandra GD">Maiandra GD</option>
    <option value="Malgun Gothic">Malgun Gothic</option>
    <option value="Malgun Gothic">Malgun Gothic</option>
    <option value="Malgun Gothic">Malgun Gothic</option>
    <option value="Malgun Gothic">Malgun Gothic</option>
    <option value="Marlett">Marlett</option>
    <option value="Matura MT Script Capitals">Matura MT Script Capitals</option>
    <option value="Microsoft Himalaya">Microsoft Himalaya</option>
    <option value="Microsoft JhengHei">Microsoft JhengHei</option>
    <option value="Microsoft JhengHei UI">Microsoft JhengHei UI</option>
    <option value="Microsoft New Tai Lue">Microsoft New Tai Lue</option>
    <option value="Microsoft PhagsPa">Microsoft PhagsPa</option>
    <option value="Microsoft Sans Serif">Microsoft Sans Serif</option>
    <option value="Microsoft Tai Le">Microsoft Tai Le</option>
    <option value="Microsoft Uighur">Microsoft Uighur</option>
    <option value="Microsoft YaHei">Microsoft YaHei</option>
    <option value="Microsoft YaHei UI">Microsoft YaHei UI</option>
    <option value="Microsoft Yi Baiti">Microsoft Yi Baiti</option>
    <option value="MingLiU">MingLiU</option>
    <option value="MingLiU-ExtB">MingLiU-ExtB</option>
    <option value="MingLiU_HKSCS">MingLiU_HKSCS</option>
    <option value="MingLiU_HKSCS-ExtB">MingLiU_HKSCS-ExtB</option>
    <option value="Mistral">Mistral</option>
    <option value="Modern No. 20">Modern No. 20</option>
    <option value="Monotype Corsiva">Monotype Corsiva</option>
    <option value="MS Gothic">MS Gothic</option>
    <option value="MS Outlook">MS Outlook</option>
    <option value="MS PGothic">MS PGothic</option>
    <option value="MS PMincho">MS PMincho</option>
    <option value="MS Reference Sans Serif">MS Reference Sans Serif</option>
    <option value="MS Reference Specialty">MS Reference Specialty</option>
    <option value="MV Boli">MV Boli</option>
    <option value="Narkisim">Narkisim</option>
    <option value="Niagara Engraved">Niagara Engraved</option>
    <option value="Niagara Solid">Niagara Solid</option>
    <option value="Nirmala UI">Nirmala UI</option>
    <option value="OCR A Extended">OCR A Extended</option>
    <option value="Old English Text MT">Old English Text MT</option>
    <option value="Onyx">Onyx</option>
    <option value="Palace Script MT">Palace Script MT</option>
    <option value="Papyrus">Papyrus</option>
    <option value="Parchment">Parchment</option>
    <option value="Perpetua">Perpetua</option>
    <option value="Perpetua Titling MT">Perpetua Titling MT</option>
    <option value="Playbill">Playbill</option>
    <option value="Poor Richard">Poor Richard</option>
    <option value="Pristina">Pristina</option>
    <option value="Rage Italic">Rage Italic</option>
    <option value="Ravie">Ravie</option>
    <option value="Rockwell">Rockwell</option>
    <option value="Rockwell Condensed">Rockwell Condensed</option>
    <option value="Rockwell Extra Bold">Rockwell Extra Bold</option>
    <option value="Rod">Rod</option>
    <option value="Sakkal Majalla">Sakkal Majalla</option>
    <option value="Script">Script</option>
    <option value="Script MT Bold">Script MT Bold</option>
    <option value="Segoe MDL2 Assets">Segoe MDL2 Assets</option>
    <option value="Segoe Print">Segoe Print</option>
    <option value="Segoe Script">Segoe Script</option>
    <option value="Segoe UI">Segoe UI</option>
    <option value="Segoe UI Emoji">Segoe UI Emoji</option>
    <option value="Segoe UI Historic">Segoe UI Historic</option>
    <option value="Segoe UI Symbol">Segoe UI Symbol</option>
    <option value="Showcard Gothic">Showcard Gothic</option>
    <option value="Shruti">Shruti</option>
    <option value="SimHei">SimHei</option>
    <option value="SimSun">SimSun</option>
    <option value="SimSun-ExtB">SimSun-ExtB</option>
    <option value="Sitka Small">Sitka Small</option>
    <option value="Snap ITC">Snap ITC</option>
    <option value="Stencil">Stencil</option>
    <option value="Sylfaen">Sylfaen</option>
    <option value="Symbol">Symbol</option>
    <option value="Tahoma">Tahoma</option>
    <option value="Tempus Sans ITC">Tempus Sans ITC</option>
    <option value="Terminal">Terminal</option>
    <option value="Times New Roman">Times New Roman</option>
    <option value="Trebuchet MS">Trebuchet MS</option>
    <option value="Tw Cen MT">Tw Cen MT</option>
    <option value="Tw Cen MT Condensed">Tw Cen MT Condensed</option>
    <option value="Tw Cen MT Condensed Extra Bold">Tw Cen MT Condensed Extra Bold</option>
    <option value="Verdana">Verdana</option>
    <option value="Viner Hand ITC">Viner Hand ITC</option>
    <option value="Vivaldi">Vivaldi</option>
    <option value="Vladimir Script">Vladimir Script</option>
    <option value="Webdings">Webdings</option>
    <option value="Wide Latin">Wide Latin</option>
    <option value="Wingdings">Wingdings</option>
    <option value="Wingdings 2">Wingdings 2</option>
    <option value="Wingdings 3">Wingdings 3</option>
    <option value="Yu Gothic">Yu Gothic</option>
    <option value="Yu Gothic UI">Yu Gothic UI</option>
    <option value="Yu Gothic UI Semibold">Yu Gothic UI Semibold</option>
    <option value="Yu Gothic UI Light">Yu Gothic UI Light</option>
    <option value="Yu Gothic UI Semilight">Yu Gothic UI Semilight</option>
    <option value="Yu Gothic UI Bold">Yu Gothic UI Bold</option>
  </select>
  <select id="font-size">
    <option value="8">8</option>
    <option value="9">9</option>
    <option value="10">10</option>
    <option value="11">11</option>
    <option value="12">12</option>
    <option value="14">14</option>
    <option value="16">16</option>
    <option value="20">20</option>
    <option value="22">22</option>
    <option value="24">24</option>
    <option value="26">26</option>
    <option value="28">28</option>
    <option value="36">36</option>
    <option value="48">48</option>
    <option value="72">72</option>
    <option value="96">96</option>
    <option value="128">128</option>
    <option value="256">256</option>
    <option value="512">512</option>
</select>
  <button id="apply-stand" class="class2-button-solo"><img src="Res/bold.png" alt="img"></button>
  <button class="class2-button-solo"><img src="Res/italic.png" alt="img"></button>
  <button class="class2-button-solo"><img src="Res/underline.png" alt="img"></button>
  <div id="tool-container-text-b">
    <button class="class1-button" id="unordered-list-button"><img src="Res/lister.png" alt="img"></button>
    <button class="class1-button" id="ordered-list-button"><img src="Res/listern-um.png" alt="img"></button>
    
  </div>
</div>

<div id="tool-contener-line2">
  <button onclick="handlePrintPreviewButtonClick()" id="apply-stand-new-line" class="class2-button-solo"><img src="Res/print.png" alt="img"></button>
  <button class="class2-button-solo"><img src="Res/eraser.png" alt="img"></button>
  <div id="tool-container-text">
    <button class="class1-button" style="margin-left: 5px;"><img src="Res/align-left.png" alt="img"></button>
    <button class="class1-button"><img src="Res/align-center.png" alt="img"></button>
    <button class="class1-button"><img src="Res/align-right.png" alt="img"></button>
    <button class="class1-button"><img src="Res/justified-text.png" alt="img"></button>
    <button class="class1-button"><img src="Res/exposant.png" alt="img"></button>
    <button class="class1-button"><img src="Res/indice.png" alt="img"></button>
</div>
<div id="tool-container-color">
  <button id="black" class="class1-color-button" data-color="black"></button>
  <button id="red" class="class1-color-button" data-color="red"></button>
  <button id="orange" class="class1-color-button" data-color="orange"></button>
  <button id="yellow" class="class1-color-button" data-color="yellow"></button>
  <button id="green" class="class1-color-button" data-color="green"></button>
  <button id="bluec" class="class1-color-button" data-color="blue"></button>
  <button id="bluef" class="class1-color-button" data-color="blue"></button>
  <button id="pink" class="class1-color-button" data-color="pink"></button>
  <button id="another" class="class1-color-button"></button>
  <input type="color" id="custom-color-picker" style="display: none;">
</div>

</div>
</div>
<div id="zone2-tool-bar-top-line1-bis">
  <div id="tool-container-text-c">
    <button class="soussection" id="titre1" onclick="insertStyledText('titre1')">
      <h1>Titre 1</h1>
      <h2>Arial, 35</h2>
    </button>
    <button class="soussection" id="titre2" onclick="insertStyledText('titre2')">
      <h1>Titre 2</h1>
      <h2>Sans Serif, 35</h2>
    </button>
    <button class="soussection" id="titre3" onclick="insertStyledText('titre3')">
      <h1>Titre 3</h1>
      <h2>Sans Serif, 30</h2>
    </button>
    <button class="soussection" id="soustitre" onclick="insertStyledText('soustitre')">
      <h1>Sous-titre</h1>
      <h2>Arial, 23</h2>
    </button>
    <button class="soussection" id="citation" onclick="insertStyledText('citation')">
      <h1>Citation</h1>
      <h2>Univers, 14</h2>
    </button>
    <button class="soussection" id="sansinterligna" onclick="insertStyledText('si')">
      <h1>Sans Interligne</h1>
      <h2>Univers, 12</h2>
    </button>
    
  </div>
  <button id="tool-container-micro" onclick="startSpeechRecognition()">
    <img src="Res/microphone.png" alt="Microphone">
    <h1>Dicter</h1>
  </button>
  <button id="tool-container-sc" onclick="toggleSpecialCharacters()">
    <img src="Res/omega.png" alt="Microphone">
    <h1>Caractères</h1>
    <h1>spéciaux</h1>
  </button>
  <button id="tool-container-sc" onclick="loadMathJax();createMathEditorModal();">
    <img src="Res/formula.png" alt="Microphone">
    <h1>Formules</h1>
  </button>
  <button id="tool-container-sc" onclick="opengenema()">
    <img src="Res/GENEMA-logo.png" alt="Microphone">
    <h1>Assistant</h1>
  </button>
  <div id="special-characters-container" style="display: none;">
    <h1>--------Caractères spéciaux---------</h1>
    <button class="special-character">€</button>
  <button class="special-character">¥</button>
  <button class="special-character">£</button>
  <button class="special-character">¢</button>
  <button class="special-character">©</button>
  <button class="special-character">®</button>
  <button class="special-character">™</button>
  <button class="special-character">§</button>
  <button class="special-character">¶</button>
  <button class="special-character">†</button>
  <button class="special-character">‡</button>
  <button class="special-character">№</button>
  <button class="special-character">℗</button>
  <button class="special-character">℠</button>
  <button class="special-character">№</button>
  <button class="special-character">℠</button>
  <button class="special-character">℞</button>
  <button class="special-character">°</button>
  <button class="special-character">Ω</button>
  <button class="special-character">℃</button>
  <button class="special-character">℉</button>
  <button class="special-character">‰</button>
  <button class="special-character">←</button>
  <button class="special-character">→</button>
  <button class="special-character">↑</button>
  <button class="special-character">↓</button>
  <button class="special-character">↔</button>
  <button class="special-character">↕</button>
  <button class="special-character">↖</button>
  <button class="special-character">↗</button>
  <button class="special-character">↘</button>
  <button class="special-character">↙</button>
  <button class="special-character">◊</button>
  <button class="special-character">♠</button>
  <button class="special-character">♣</button>
  <button class="special-character">♥</button>
  <button class="special-character">♦</button>
  <button class="special-character">♪</button>
  <button class="special-character">♫</button>
  <button class="special-character">♩</button>
  <button class="special-character">♬</button>
  <button class="special-character">✓</button>
  <button class="special-character">✗</button>
  <button class="special-character">✰</button>
  <button class="special-character">✱</button>
  <button class="special-character">✲</button>
  <button class="special-character">✳</button>
  <button class="special-character">✴</button>
  <button class="special-character">✵</button>
  <button class="special-character">✶</button>
  <button class="special-character">✷</button>
  <button class="special-character">✸</button>
  <button class="special-character">✹</button>
  <button class="special-character">✺</button>
  <button class="special-character">✻</button>
  <button class="special-character">✼</button>
  <button class="special-character">✽</button>
  <button class="special-character">✾</button>
  <button class="special-character">✿</button>
  <button class="special-character">❀</button>
  <button class="special-character">❁</button>
  <button class="special-character">❂</button>
  <button class="special-character">❃</button>
  <button class="special-character">❄</button>
  <button class="special-character">❅</button>
  <button class="special-character">❆</button>
  <button class="special-character">❇</button>
  <button class="special-character">❈</button>
  <button class="special-character">❉</button>
  <button class="special-character">❊</button>
  <button class="special-character">❋</button>
  <button class="special-character">❍</button>
  <button class="special-character">❏</button>
  <button class="special-character">❐</button>
  <button class="special-character">❑</button>
  <button class="special-character">❒</button>
  <button class="special-character">❖</button>
  <button class="special-character">❘</button>
  <button class="special-character">❙</button>
  <button class="special-character">❚</button>
  <button class="special-character">❛</button>
  <button class="special-character">❜</button>
  <button class="special-character">❝</button>
  <button class="special-character">❞</button>
  <button class="special-character">❡</button>
  <button class="special-character">❢</button>
  <button class="special-character">❣</button>
  <button class="special-character">❤</button>
  <button class="special-character">❥</button>
  <button class="special-character">❦</button>
  <button class="special-character">❧</button>
  <button class="special-character">☀</button>
  <button class="special-character">☁</button>
  <button class="special-character">☂</button>
  <button class="special-character">☃</button>
  <button class="special-character">☄</button>
  <button class="special-character">★</button>
  <button class="special-character">☆</button>
  <button class="special-character">☇</button>
  <button class="special-character">☈</button>
  <button class="special-character">☉</button>
  <button class="special-character">☊</button>
  <button class="special-character">☋</button>
  <button class="special-character">☌</button>
  <button class="special-character">☍</button>
  <button class="special-character">☎</button>
  <button class="special-character">☏</button>
  <button class="special-character">☐</button>
  <button class="special-character">☑</button>
  <button class="special-character">☒</button>
  <button class="special-character">☓</button>
  <button class="special-character">☖</button>
  <button class="special-character">☗</button>
  <button class="special-character">☘</button>
  <button class="special-character">☙</button>
  <button class="special-character">☚</button>
  <button class="special-character">☛</button>
  <button class="special-character">☜</button>
  <button class="special-character">☞</button>
  <button class="special-character">☟</button>
  <button class="special-character">☠</button>
  <button class="special-character">☡</button>
  <button class="special-character">☢</button>
  <button class="special-character">☣</button>
  <button class="special-character">☤</button>
  <button class="special-character">☥</button>
  <button class="special-character">☦</button>
  <button class="special-character">☧</button>
  <button class="special-character">☨</button>
  <button class="special-character">☩</button>
  <button class="special-character">☪</button>
  <button class="special-character">☫</button>
  <button class="special-character">☬</button>
  <button class="special-character">☭</button>
  <button class="special-character">☮</button>
  <button class="special-character">☯</button>
  <button class="special-character">☰</button>
  <button class="special-character">☱</button>
  <button class="special-character">☲</button>
  <button class="special-character">☳</button>
  <button class="special-character">☴</button>
  <button class="special-character">☵</button>
  <button class="special-character">☶</button>
  <button class="special-character">☷</button>
  <button class="special-character">☸</button>
  <button class="special-character">☹</button>
  <button class="special-character">☺</button>
  <button class="special-character">☻</button>
  <button class="special-character">☼</button>
  <button class="special-character">☽</button>
  <button class="special-character">☾</button>
  <button class="special-character">☿</button>
  <button class="special-character">♀</button>
  <button class="special-character">♂</button>
  <button class="special-character">♃</button>
  <button class="special-character">♄</button>
  <button class="special-character">♅</button>
  <button class="special-character">♆</button>
  <button class="special-character">♇</button>
  <button class="special-character">♔</button>
  <button class="special-character">♕</button>
  <button class="special-character">♖</button>
  <button class="special-character">♗</button>
  <button class="special-character">♘</button>
  <button class="special-character">♙</button>
  <button class="special-character">♚</button>
  <button class="special-character">♛</button>
  <button class="special-character">♜</button>
  <button class="special-character">♝</button>
  <button class="special-character">♞</button>
  <button class="special-character">♟</button>
  <button class="special-character">♠</button>
  <button class="special-character">♡</button>
  <button class="special-character">♢</button>
  <button class="special-character">♣</button>
  <button class="special-character">♤</button>
  <button class="special-character">♥</button>
  <button class="special-character">♦</button>
  <button class="special-character">♧</button>
  <button class="special-character">♨</button>
  <button class="special-character">♩</button>
  <button class="special-character">♫</button>
  <button class="special-character">♬</button>
  <button class="special-character">♭</button>
  <button class="special-character">♮</button>
  <button class="special-character">♯</button>
  <button class="special-character">♰</button>
  <button class="special-character">♱</button>
  <button class="special-character">♲</button>
  <button class="special-character">♳</button>
  <button class="special-character">♴</button>
  <button class="special-character">♵</button>
  <button class="special-character">♶</button>
  <button class="special-character">♷</button>
  <button class="special-character">♸</button>
  <button class="special-character">♹</button>
  <button class="special-character">♺</button>
  <button class="special-character">♻</button>
  <button class="special-character">♼</button>
  <button class="special-character">♽</button>
  <button class="special-character">♾</button>
  <h1>---------------emoji----------------</h1>
  <button class="special-character">😀</button>
  <button class="special-character">😃</button>
  <button class="special-character">😄</button>
  <button class="special-character">😁</button>
  <button class="special-character">😆</button>
  <button class="special-character">😅</button>
  <button class="special-character">😂</button>
  <button class="special-character">🤣</button>
  <button class="special-character">😊</button>
  <button class="special-character">😇</button>
  <button class="special-character">🙂</button>
  <button class="special-character">🙃</button>
  <button class="special-character">😉</button>
  <button class="special-character">😌</button>
  <button class="special-character">😍</button>
  <button class="special-character">😘</button>
  <button class="special-character">😗</button>
  <button class="special-character">😙</button>
  <button class="special-character">😚</button>
  <button class="special-character">😋</button>
  <button class="special-character">😛</button>
  <button class="special-character">😜</button>
  <button class="special-character">😝</button>
  <button class="special-character">🤑</button>
  <button class="special-character">🤗</button>
  <button class="special-character">🤓</button>
  <button class="special-character">😎</button>
  <button class="special-character">🤡</button>
  <button class="special-character">🤠</button>
  <button class="special-character">😏</button>
  <button class="special-character">😒</button>
  <button class="special-character">😞</button>
  <button class="special-character">😔</button>
  <button class="special-character">😟</button>
  <button class="special-character">😕</button>
  <button class="special-character">🙁</button>
  <button class="special-character">☹️</button>
  <button class="special-character">😣</button>
  <button class="special-character">😖</button>
  <button class="special-character">😫</button>
  <button class="special-character">😩</button>
  <button class="special-character">😢</button>
  <button class="special-character">😭</button>
  <button class="special-character">😤</button>
  <button class="special-character">😠</button>
  <button class="special-character">😡</button>
  <button class="special-character">😶</button>
  <button class="special-character">😐</button>
  <button class="special-character">😑</button>
  <button class="special-character">😯</button>
  <button class="special-character">😦</button>
  <button class="special-character">😧</button>
  <button class="special-character">😮</button>
  <button class="special-character">😲</button>
  <button class="special-character">😴</button>
  <button class="special-character">🤤</button>
  <button class="special-character">😪</button>
  <button class="special-character">😵</button>
  <button class="special-character">🤐</button>
  <button class="special-character">🤢</button>
  <button class="special-character">🤧</button>
  <button class="special-character">😷</button>
  <button class="special-character">🤒</button>
  <button class="special-character">🤕</button>
  <button class="special-character">😈</button>
  <button class="special-character">👿</button>
  <button class="special-character">👹</button>
  <button class="special-character">👺</button>
  <button class="special-character">💀</button>
  <button class="special-character">👻</button>
  <button class="special-character">👽</button>
  <button class="special-character">👾</button>
  <button class="special-character">🤖</button>
  <button class="special-character">💩</button>
  <button class="special-character">😺</button>
  <button class="special-character">😸</button>
  <button class="special-character">😹</button>
  <button class="special-character">😻</button>
  <button class="special-character">😼</button>
  <button class="special-character">😽</button>
  <button class="special-character">🙀</button>
  <button class="special-character">😿</button>
  <button class="special-character">😾</button>
  <h1>--------Alphabet Cyrillique---------</h1>
  <button class="special-character">А</button>
<button class="special-character">Б</button>
<button class="special-character">В</button>
<button class="special-character">Г</button>
<button class="special-character">Д</button>
<button class="special-character">Е</button>
<button class="special-character">Ё</button>
<button class="special-character">Ж</button>
<button class="special-character">З</button>
<button class="special-character">И</button>
<button class="special-character">Й</button>
<button class="special-character">К</button>
<button class="special-character">Л</button>
<button class="special-character">М</button>
<button class="special-character">Н</button>
<button class="special-character">О</button>
<button class="special-character">П</button>
<button class="special-character">Р</button>
<button class="special-character">С</button>
<button class="special-character">Т</button>
<button class="special-character">У</button>
<button class="special-character">Ф</button>
<button class="special-character">Х</button>
<button class="special-character">Ц</button>
<button class="special-character">Ч</button>
<button class="special-character">Ш</button>
<button class="special-character">Щ</button>
<button class="special-character">Ъ</button>
<button class="special-character">Ы</button>
<button class="special-character">Ь</button>
<button class="special-character">Э</button>
<button class="special-character">Ю</button>
<button class="special-character">Я</button>
<h1>-----------Alphabet arabe-----------</h1>
<button class="special-character">ا</button>
<button class="special-character">ب</button>
<button class="special-character">ت</button>
<button class="special-character">ث</button>
<button class="special-character">ج</button>
<button class="special-character">ح</button>
<button class="special-character">خ</button>
<button class="special-character">د</button>
<button class="special-character">ذ</button>
<button class="special-character">ر</button>
<button class="special-character">ز</button>
<button class="special-character">س</button>
<button class="special-character">ش</button>
<button class="special-character">ص</button>
<button class="special-character">ض</button>
<button class="special-character">ط</button>
<button class="special-character">ظ</button>
<button class="special-character">ع</button>
<button class="special-character">غ</button>
<button class="special-character">ف</button>
<button class="special-character">ق</button>
<button class="special-character">ك</button>
<button class="special-character">ل</button>
<button class="special-character">م</button>
<button class="special-character">ن</button>
<button class="special-character">ه</button>
<button class="special-character">و</button>
<button class="special-character">ي</button>
<button class="special-character">ى</button>
<button class="special-character">ئ</button>
<button class="special-character">ء</button>
<button class="special-character">ؤ</button>
<button class="special-character">إ</button>
<button class="special-character">أ</button>
<button class="special-character">آ</button>
<h1>------------Alphabet grec-----------</h1>
<button class="special-character">Α</button>
<button class="special-character">Β</button>
<button class="special-character">Γ</button>
<button class="special-character">Δ</button>
<button class="special-character">Ε</button>
<button class="special-character">Ζ</button>
<button class="special-character">Η</button>
<button class="special-character">Θ</button>
<button class="special-character">Ι</button>
<button class="special-character">Κ</button>
<button class="special-character">Λ</button>
<button class="special-character">Μ</button>
<button class="special-character">Ν</button>
<button class="special-character">Ξ</button>
<button class="special-character">Ο</button>
<button class="special-character">Π</button>
<button class="special-character">Ρ</button>
<button class="special-character">Σ</button>
<button class="special-character">Τ</button>
<button class="special-character">Υ</button>
<button class="special-character">Φ</button>
<button class="special-character">Χ</button>
<button class="special-character">Ψ</button>
<button class="special-character">Ω</button>
<button class="special-character">α</button>
<button class="special-character">β</button>
<button class="special-character">γ</button>
<button class="special-character">δ</button>
<button class="special-character">ε</button>
<button class="special-character">ζ</button>
<button class="special-character">η</button>
<button class="special-character">θ</button>
<button class="special-character">ι</button>
<button class="special-character">κ</button>
<button class="special-character">λ</button>
<button class="special-character">μ</button>
<button class="special-character">ν</button>
<button class="special-character">ξ</button>
<button class="special-character">ο</button>
<button class="special-character">π</button>
<button class="special-character">ρ</button>
<button class="special-character">σ</button>
<button class="special-character">τ</button>
<button class="special-character">υ</button>
<button class="special-character">φ</button>
<button class="special-character">χ</button>
<button class="special-character">ψ</button>
<button class="special-character">ω</button>
<h1>----------Alphabet hébreu-----------</h1>
<button class="special-character">א</button>
<button class="special-character">ב</button>
<button class="special-character">ג</button>
<button class="special-character">ד</button>
<button class="special-character">ה</button>
<button class="special-character">ו</button>
<button class="special-character">ז</button>
<button class="special-character">ח</button>
<button class="special-character">ט</button>
<button class="special-character">י</button>
<button class="special-character">כ</button>
<button class="special-character">ל</button>
<button class="special-character">מ</button>
<button class="special-character">נ</button>
<button class="special-character">ס</button>
<button class="special-character">ע</button>
<button class="special-character">פ</button>
<button class="special-character">צ</button>
<button class="special-character">ק</button>
<button class="special-character">ר</button>
<button class="special-character">ש</button>
<button class="special-character">ת</button>

</div>
</div>

</div>
<div id="zoom-contener">
  <img id="zoom-image" src="Res/magnifier.png" alt="Zomm1">
  <input type="range" min="50" max="200" value="100" class="barre-zoom" id="zoomBar">
  <span id="valeur-zoom">100%</span>
</div>
  <div id="content">
    
    <div id="editor" contenteditable="true"></div>
  </div>
  <div id="myModal" class="modal">
    <div class="modal-content">
      <span class="closebtn">&times;</span>
      
      <!-- Onglets -->
      <div class="tabs">
        <button class="tablinks" onclick="openTab(event, 'Page')">Page</button>
        <button class="tablinks" onclick="openTab(event, 'Insertion')">Insertion</button>
        <button class="tablinks" onclick="openTab(event, 'MiseEnPage')">Mise en page</button>
        <button class="tablinks" onclick="openTab(event, 'Autre')">Autre</button>
      </div>
      
      <!-- Contenu des onglets -->
      <div id="Page" class="tabcontent">
        <!-- Ajoutez ici le contenu de l'onglet "Page" -->
      </div>
      
      <div id="Insertion" class="tabcontent">
        <h3>Insertion</h3>
        <h4>Inserer un tableau</h4>
        <label for="num-rows">Nombre de lignes :</label>
        <input type="number" id="num-rows" min="1" value="3"><br>
        <label for="num-cols">Nombre de colonnes :</label>
        <input type="number" id="num-cols" min="1" value="3"><br>
        <button id="insert-table-btn">Insérer un tableau</button>
        <h4>Inserer une image :</h4>
        <input type="file" id="image-input" accept="image/*">
        <button id="insert-image-btn">Insérer une image</button>
        <p>ATTENTION : Si votre image est plus grande que la zone de texte, elle sera automatiquement cachée</p>
        <!--<button onclick="insererDiagramme()">Inserer un diagramme</button>    //en cours de developement-->
      </div>
      
      <div id="MiseEnPage" class="tabcontent">
        <h3>Mise en page</h3>
      <h4>Orientation de la page :</h4>
      <label><input type="radio" name="orientation" value="portrait" checked> Portrait</label>
      <label><input type="radio" name="orientation" value="landscape"> Paysage</label>
      <p>Le type de feuille est actuellement 'A4'</p>
      <h4>Format de papier :</h4>
      <select id="paper-size">
        <option value="A4">A4</option>
        <option value="A5">A5</option>
        <option value="Letter">Lettre US</option>
        <option value="Legal">Legal US</option>
      </select>
      <h4>Marges :</h4>
      <select id="margin-size">
        <option value="no">Aucune marge</option>
        <option value="narrow">Étroite (marge de 10mm)</option>
        <option value="normal" selected>Normale (marge de 20mm)</option>
        <option value="wide">Large (marge de 30mm)</option>
        <!-- Ajoutez d'autres options de marges si nécessaire -->
      </select>
      <ul>
        <li><strong>Étroite :</strong> Une marge de 10 mm.</li>
        <li><strong>Normale :</strong> Une marge de 20 mm.</li>
        <li><strong>Large :</strong> Une marge de 30 mm.</li>
      </ul>
      
      </div>
      
      <div id="Autre" class="tabcontent">
        <h3>Autre</h3>
        <!-- Ajoutez ici le contenu de l'onglet "Autre" -->
      </div>
    </div>
  </div>

<div class="genema" id="genema-id">
  <div id="barre-gen">
    <img src="Res/GENEMA-logo.png" alt="logo">
    <h2>GENAIMA</h2>
  </div>
  <p>Votre assistant intelligent pas si intelligent.</p>
  <div id="output"></div>
  <button id="correct" onclick="displayBotMessage('<p>Analyse du texte en cours... Votre navigateur peut ne plus répondre en fonction de votre machine.</p>'); setTimeout(function() { corriger(); }, 5000);">Analyser mon texte</button>
</div>
<script>
  const chatOutput = document.getElementById('output');
  
  function displayBotMessage(message) {
    const chatOutput = document.getElementById('output');
    const messageElement = document.createElement('div');
    messageElement.classList.add('message', 'bot-message');

    // Créer un conteneur pour l'image et le nom du bot
    const botContainer = document.createElement('div');
    botContainer.classList.add('user-container'); // Utilise le même style que pour l'utilisateur

    // Ajouter le conteneur à l'élément de message
    messageElement.appendChild(botContainer);

    // Créer un élément pour le texte du message
    const textElement = document.createElement('p');
    textElement.classList.add('message-text');

    // Ajouter le texte du message initialement vide
    messageElement.appendChild(textElement);

    chatOutput.appendChild(messageElement);

    // Séparer les balises HTML et le texte brut
    const tempDiv = document.createElement('div');
    tempDiv.innerHTML = message; // Remplir temporairement un div avec le message HTML
    const textContent = tempDiv.textContent || tempDiv.innerText || ''; // Récupérer seulement le texte
    const htmlContent = tempDiv.innerHTML; // Récupérer le HTML complet

    // Animer le texte une lettre à la fois
    let index = 0;
    textElement.textContent = '';  // Vider le texte avant de commencer l'animation

    // Animer l'écriture du texte une lettre à la fois
    const interval = setInterval(() => {
        if (index < textContent.length) {
            textElement.textContent += textContent.charAt(index); // Ajouter une lettre à la fois
            index++;
        } else {
            clearInterval(interval);
            textElement.innerHTML = htmlContent; // Insérer le HTML complet une fois l'animation terminée
        }
    }, 30);  // Intervalle de 30 ms entre chaque caractère
}
  //-------------------------------------------------------------------Backend genema-------------------------------------------------------------------

let dictionnaire = new Set();

fetch('genema/dictionary.csv')
    .then(response => response.text())
    .then(data => {
        dictionnaire = new Set(data.split('\n').map(mot => mot.trim().toLowerCase()));
    })
    .catch(err => console.error('Erreur lors du chargement du dictionnaire:', err));

function calculerDistanceLevenshtein(a, b) {
    if (a.length === 0) return b.length;
    if (b.length === 0) return a.length;

    let matrix = Array(a.length + 1).fill(null).map(() => Array(b.length + 1).fill(null));

    for (let i = 0; i <= a.length; i++) matrix[i][0] = i;
    for (let j = 0; j <= b.length; j++) matrix[0][j] = j;

    for (let i = 1; i <= a.length; i++) {
        for (let j = 1; j <= b.length; j++) {
            const cout = a[i - 1] === b[j - 1] ? 0 : 1;
            matrix[i][j] = Math.min(
                matrix[i - 1][j] + 1,   // Suppression
                matrix[i][j - 1] + 1,   // Insertion
                matrix[i - 1][j - 1] + cout // Substitution
            );

            // Transposition (ex: "paer" -> "père")
            if (
                i > 1 &&
                j > 1 &&
                a[i - 1] === b[j - 2] &&
                a[i - 2] === b[j - 1]
            ) {
                matrix[i][j] = Math.min(matrix[i][j], matrix[i - 2][j - 2] + 1);
            }
        }
    }

    return matrix[a.length][b.length];
}

function trouverCorrections(mot) {
    const seuil = mot.length <= 4 ? 1 : 2; // Petits mots = tolérance plus faible
    let suggestions = [];

    dictionnaire.forEach(dicoMot => {
        const distance = calculerDistanceLevenshtein(mot, dicoMot);
        if (distance <= seuil) {
            suggestions.push({ mot: dicoMot, score: distance });
        }
    });

    // Trier les suggestions par distance croissante
    return suggestions.sort((a, b) => a.score - b.score).slice(0, 5).map(s => s.mot);
}

function remplacerMot(ancienMot, nouveauMot) {
    const inputText = document.getElementById('editor');
    let texte = inputText.innerHTML;

    // Remplacement avec regex pour éviter les mauvaises substitutions
    inputText.innerHTML = texte.replace(new RegExp(`\\b${ancienMot}\\b`, 'g'), nouveauMot);

    // Refaire l'analyse après correction
    corriger();
}

function corriger() {
    const inputText = document.getElementById('editor');
    
    if (!inputText) {
        console.error('Élément #editor introuvable');
        return;
    }

    let texte = inputText.innerText.trim();
    if (!texte) {
        displayBotMessage('Aucun texte à analyser.');
        return;
    }

    const mots = texte.split(/\s+/);
    let resultatHTML = '<p>📝 <strong>Résultats de l\'analyse :</strong></p><ul>'; 
    let erreurs = 0;

    mots.forEach(mot => {
        const motNettoye = mot.replace(/[.,!?;:()"']/g, '').toLowerCase();

        if (motNettoye.length > 2 && !dictionnaire.has(motNettoye)) {
            const suggestions = trouverCorrections(motNettoye);
            erreurs++;

            resultatHTML += `<li>❌ <strong>${mot}</strong> 
                <ul class="suggestions-list">
                    <li>🔹 Suggestions : ${
                        suggestions.length > 0
                            ? suggestions.map(s => `<a href="#" class="suggestion" onclick="remplacerMot('${mot}', '${s}')">${s}</a>`).join(', ')
                            : 'Aucune suggestion disponible'
                    }</li>
                </ul>
            </li>`;
        }
    });

    resultatHTML += '</ul>';

    if (erreurs === 0) {
        resultatHTML = '<p>✅ Aucune erreur détectée !</p>';
    }

    displayBotMessage(resultatHTML);
}

  </script>
<script>
//-------------------------------------------------------------------------charspe-----------------------------------------------------------
function toggleSpecialCharacters() {
    var specialCharactersContainer = document.getElementById('special-characters-container');
    if (specialCharactersContainer.style.display === 'none') {
      specialCharactersContainer.style.display = 'flex';
    } else {
      specialCharactersContainer.style.display = 'none';
    }
  }
// Sélection de la div contenant les caractères spéciaux
const specialCharactersContainer = document.getElementById('special-characters-container');

// Sélection de tous les boutons de caractères spéciaux
const specialCharacterButtons = document.querySelectorAll('.special-character');

// Ajout d'un gestionnaire d'événements pour chaque bouton de caractères spéciaux
specialCharacterButtons.forEach(button => {
    button.addEventListener('click', () => {
        // Récupérer le caractère spécial associé à ce bouton
        const specialCharacter = button.textContent;

        // Insérer le caractère spécial dans l'éditeur de texte
        const editor = document.getElementById('editor');
        editor.focus();
        document.execCommand('insertText', false, specialCharacter);
    });
});

//------------------------------------------------------------------------Voice rec----------------------------------------------------------
// Variables globales pour l'élément de l'icône du microphone et l'objet AnalyserNode
let microphoneIcon;
let analyser;

// Fonction pour démarrer la visualisation audio
function startAudioVisualization() {
  // Récupérer l'élément de l'icône du microphone
  microphoneIcon = document.getElementById('microphoneIcon');
  
  // Créer un objet AnalyserNode pour analyser les données audio
  const audioContext = new (window.AudioContext || window.webkitAudioContext)();
  analyser = audioContext.createAnalyser();

  // Configurer l'analyser
  analyser.fftSize = 256;
  const bufferLength = analyser.frequencyBinCount;
  const dataArray = new Uint8Array(bufferLength);

  // Obtenir le flux audio du microphone
  navigator.mediaDevices.getUserMedia({ audio: true })
    .then(stream => {
      const source = audioContext.createMediaStreamSource(stream);
      source.connect(analyser);

      // Mettre à jour l'effet visuel en fonction du niveau audio
      function draw() {
        requestAnimationFrame(draw);
        analyser.getByteFrequencyData(dataArray);
        // Calculer la valeur moyenne des données de fréquence pour obtenir un niveau audio global
        const audioLevel = dataArray.reduce((acc, val) => acc + val, 0) / bufferLength / 255;
        updateMicrophoneVisuals(audioLevel);
      }
      draw();
    })
    .catch(error => {
      console.error('Erreur lors de la récupération du flux audio du microphone :', error);
    });
}

// Fonction pour arrêter la visualisation audio
function stopAudioVisualization() {
  if (analyser) {
    analyser.disconnect(); // Déconnecter l'analyser du flux audio
    resetMicrophoneVisuals(); // Réinitialiser l'effet visuel
  }
}

// Fonction pour mettre à jour l'effet visuel en fonction du niveau audio
function updateMicrophoneVisuals(audioLevel) {
  // Convertir le niveau audio en une valeur d'ombre pour l'effet de box-shadow
  const boxShadowValue = `${audioLevel * 20}px ${audioLevel * 20}px ${audioLevel * 40}px rgba(255, 0, 0, ${audioLevel})`;
  // Appliquer l'effet de box-shadow à l'icône du microphone
  microphoneIcon.style.boxShadow = boxShadowValue;
}

// Fonction pour réinitialiser l'effet visuel
function resetMicrophoneVisuals() {
  // Réinitialiser l'effet de box-shadow à sa valeur par défaut
  if (microphoneIcon) {
    microphoneIcon.style.boxShadow = 'none';
  }
}
//---------------PUR----------------
// Fonction pour initialiser la reconnaissance vocale
function initializeSpeechRecognition() {
  const microphoneIcon = document.getElementById('microphoneIcon');
  const titreElement = document.getElementById('titled');

  // Vérifiez si SpeechRecognition est pris en charge par le navigateur
  if ('SpeechRecognition' in window || 'webkitSpeechRecognition' in window) {
    // Créez un objet SpeechRecognition
    const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();

    // Configurez les paramètres de reconnaissance
    recognition.continuous = true; // Permet une dictée continue
    recognition.lang = 'fr-FR'; // Langue de reconnaissance (français)

    // Événement appelé lorsque la reconnaissance de la parole est terminée
    recognition.onresult = function(event) {
      const transcript = event.results[event.results.length - 1][0].transcript;
      // Insérez le texte reconnu dans votre éditeur
      const editor = document.getElementById('editor');
      editor.innerHTML += transcript + ' '; // Ajoute le texte à l'éditeur
    };

    // Événement appelé en cas d'erreur
    recognition.onerror = function(event) {
      console.error('Une erreur est survenue lors de la reconnaissance vocale :', event.error);
      microphoneIcon.src = 'Res/close.png';
      titreElement.textContent = event.error + " error";
    };

    // Retournez l'objet de reconnaissance vocale pour permettre l'arrêt ultérieur
    return recognition;
  } else {
    // Le navigateur ne prend pas en charge l'API Web Speech
    console.error('Le navigateur ne prend pas en charge l\'API Web Speech');
    titreElement.textContent = "Non supporté";
    return null;
  }
}

// Variable pour stocker l'objet de reconnaissance vocale
let recognition;
const stopper = document.getElementById('tool-container-micro-act');
// Fonction pour démarrer la reconnaissance vocale
function startSpeechRecognition() {
  // Vérifiez si la reconnaissance n'est pas déjà en cours
  if (!recognition) {
    recognition = initializeSpeechRecognition();
    stopper.style.display = 'block';
    startAudioVisualization();
  }
  // Vérifiez si la reconnaissance est prête
  if (recognition) {
    recognition.start();
    stopper.style.display = 'block';
  }
}

// Fonction pour arrêter la reconnaissance vocale
function stopSpeechRecognition() {
  stopAudioVisualization();
  // Vérifiez si la reconnaissance est en cours
  if (recognition && recognition.abort) {
    stopper.style.display = 'none';
    recognition.abort();
    recognition = null; // Réinitialisez l'objet de reconnaissance vocale
  }
}
//------------------------------------------------------------------------Styliste de texte-------------------------------------------------------------
function insertStyledText(name) {
  const editor = document.getElementById('editor');
  const styledText = document.createElement('span');
  if(name === 'titre1') {
    styledText.textContent = '[Votre titre ici]';
  // Appliquer le style directement depuis JavaScript
  styledText.style.color = 'rgb(18, 18, 131)';
  styledText.style.fontFamily = 'Arial';
  styledText.style.fontSize = '35px';
  styledText.style.fontStyle = 'italic';
  // Insérer le texte stylisé dans l'éditeur
  editor.appendChild(styledText);
  }
  if(name === 'titre2') {
    styledText.textContent = '[Votre titre ici]';
  // Appliquer le style directement depuis JavaScript
  styledText.style.color = 'rgb(252, 193, 0)';
  styledText.style.fontFamily = 'sans-serif';
  styledText.style.fontSize = '35px';
  styledText.style.fontStyle = 'italic';
  // Insérer le texte stylisé dans l'éditeur
  editor.appendChild(styledText);
  }
  if(name === 'titre3') {
    styledText.textContent = '[Votre titre ici]';
  // Appliquer le style directement depuis JavaScript
  styledText.style.color = 'rgb(61, 61, 61)';
  styledText.style.fontFamily = 'sans-serif';
  styledText.style.fontSize = '30px';
  styledText.style.fontStyle = 'italic';
  // Insérer le texte stylisé dans l'éditeur
  editor.appendChild(styledText);
  }
  if(name === 'soustitre') {
    styledText.textContent = '[Votre texte ici]';
  // Appliquer le style directement depuis JavaScript
  styledText.style.color = 'rgb(48, 48, 48)';
  styledText.style.fontFamily = 'Arial';
  styledText.style.fontSize = '23px';
  // Insérer le texte stylisé dans l'éditeur
  editor.appendChild(styledText);
  }
  if(name === 'citation') {
    styledText.textContent = '"Votre citation ici"';
  // Appliquer le style directement depuis JavaScript
  styledText.style.color = 'gray';
  styledText.style.fontFamily = 'Univers';
  styledText.style.fontSize = '14px';
  styledText.style.fontStyle = 'italic';
  // Insérer le texte stylisé dans l'éditeur
  editor.appendChild(styledText);
  }
  if(name === 'si') {
    styledText.textContent = '[Votre texte ici]';
  // Appliquer le style directement depuis JavaScript
  styledText.style.color = 'black';
  styledText.style.fontFamily = 'Univers';
  styledText.style.fontSize = '12px';
  // Insérer le texte stylisé dans l'éditeur
  editor.appendChild(styledText);
  }


}
//-----------------------------------------------------------------------Gestion de la connection a prismID-----------------------------------------------
      var popupWindow;
  
      // Fonction pour ouvrir la fenêtre contextuelle
      function openPopup() {
          var width = 500;
          var height = 600;
          var left = (window.innerWidth - width) / 2;
          var top = (window.innerHeight - height) / 2;
          var options = 'toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=' + width + ', height=' + height + ', top=' + top + ', left=' + left;
  
          popupWindow = window.open('auth/0/Connection.html', 'Popup', options);
      }
  
      // Fonction appelée après la connexion réussie dans la fenêtre contextuelle
      function onLoginSuccess(userInfo) {
          // Extrayez l'e-mail de l'utilisateur
          var userEmail = userInfo.email;
          // Fermez la fenêtre contextuelle après traitement des informations
          if (popupWindow) {
              popupWindow.close();
          }
      }
  </script>
  <script>
    window.addEventListener('DOMContentLoaded', function() {
  // Sélectionnez les éléments par leur ID
  var topBar = document.getElementById('top-bar');
  var middleBar = document.getElementById('middle-bar');
  var content = document.getElementById('content');
  
  // Calcul de la hauteur du contenu en pourcentage
  var topBarHeight = topBar.offsetHeight; // Hauteur de #topbar
  var middleBarHeight = middleBar.offsetHeight; // Hauteur de #middle-bar
  var windowHeight = window.innerHeight; // Hauteur de la fenêtre du navigateur
  
  var contentHeightPercentage = 100 - (topBarHeight / windowHeight * 100) - (middleBarHeight / windowHeight * 100); // Calcul de la hauteur de #content en pourcentage
  
  // Définir la hauteur de #content en pourcentage
  content.style.height = contentHeightPercentage + '%';
});
    //------------------------------------------------------Gestion menu---------------------------------------------------------
    const menu = document.getElementById('menu');
const menudev = document.getElementById('menudev');

menudev.addEventListener('click', (event) => {
    event.stopPropagation(); // Arrête la propagation de l'événement pour éviter la fermeture immédiate du menu
    toggleMenu(); // Afficher ou masquer le menu
});

// Écouter les clics en dehors du menu pour le masquer
document.addEventListener('click', (event) => {
    const isClickInsideMenu = menu.contains(event.target);
    if (!isClickInsideMenu) {
        menu.style.left = "-100%"; // Masquer le menu si le clic est en dehors du menu
    }
});

function toggleMenu() {
    // Si le menu est actuellement affiché, masquez-le. Sinon, affichez-le.
    if (menu.style.left === "0px" || menu.style.left === "") {
        menu.style.left = "-100%"; // Masquer le menu
    } else {
        menu.style.left = "0"; // Afficher le menu
    }
}
    //------------------------------------------------------IMPRESSION-----------------------------------------------------------
    const printButton = document.getElementById('apply-stand-new-line');

// Ajoutez un écouteur d'événements au bouton d'impression
function printContent() {
    const printContent = document.getElementById('editor').innerHTML;
    const printWindow = window.open('', '', 'width=600,height=600');
    printWindow.document.open();
    printWindow.document.write(`
        <html>
        <head>
            <title>Impression</title>
            <style>
              table {
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid black;
            padding: 8px;
            overflow: hidden; /* Affiche les barres de défilement si nécessaire */
        }
                @page {
                    size: ${getPaperSize()} ${getOrientation()}; /* Définir la taille du papier et l'orientation */
                    margin: ${getMargin()}; /* Définir les marges */
                }
                body {
                    font-size: 12px; /* Définir la taille de la police */
                    margin: 0; /* Réinitialiser les marges du corps */
                }
            </style>
        </head>
        <body>
            ${printContent}
        </body>
        </html>
    `);
    printWindow.document.close();
    printWindow.print();
    printWindow.close();
}

// Fonction pour obtenir la taille du papier sélectionnée
function getPaperSize() {
    const paperSizeSelect = document.getElementById('paper-size');
    return paperSizeSelect.value;
}

// Fonction pour obtenir l'orientation sélectionnée
function getOrientation() {
    const orientationSelect = document.querySelector('input[name="orientation"]:checked');
    return orientationSelect.value;
}

// Fonction pour obtenir les marges sélectionnées
function getMargin() {
    const marginSelect = document.getElementById('margin-size');
    return marginSelect.value + 'mm'; // Suppose que les marges sont en millimètres
}
//--------------------------NEW-----------------------------
function openPrintPreviewModal() {
       // Afficher la fenêtre modale
    document.getElementById('imprprev').style.display = 'block';
}

// Fonction pour fermer le modal d'aperçu avant impression
function closePrintPreviewModal() {
  document.getElementById("imprprev").style.display = "none";
}

// Fonction pour afficher le contenu dans l'aperçu avant impression
function displayContentForPrintPreview() {
  // Insérez ici le code pour récupérer et afficher le contenu à imprimer dans l'aperçu
}

// Fonction appelée lorsque le bouton "Aperçu avant impression" est cliqué
function handlePrintPreviewButtonClick() {
  displayContentForPrintPreview(); // Afficher le contenu dans l'aperçu avant impression
  openPrintPreviewModal(); // Ouvrir le modal d'aperçu avant impression
}
    //---------------------------------------------------ADVANCETEXTOPTION-----------------------------------------------------------
    // Sélection des boutons
const alignLeftButton = document.querySelector('.class1-button:nth-of-type(1)');
const alignCenterButton = document.querySelector('.class1-button:nth-of-type(2)');
const alignRightButton = document.querySelector('.class1-button:nth-of-type(3)');
const justifyButton = document.querySelector('.class1-button:nth-of-type(4)'); // Nouveau bouton pour le texte justifié
const superscriptButton = document.querySelector('.class1-button:nth-of-type(5)');
const subscriptButton = document.querySelector('.class1-button:nth-of-type(6)');
const unorderedListButton = document.getElementById('unordered-list-button');
const orderedListButton = document.getElementById('ordered-list-button');

// Fonction pour récupérer la sélection de texte
function getSelectedText() {
  return window.getSelection().toString();
}

// Écouteurs d'événements pour chaque bouton
alignLeftButton.addEventListener('click', () => {
  document.execCommand('justifyLeft', false, null);
});

alignCenterButton.addEventListener('click', () => {
  document.execCommand('justifyCenter', false, null);
});

alignRightButton.addEventListener('click', () => {
  document.execCommand('justifyRight', false, null);
});

justifyButton.addEventListener('click', () => {
  const selectedText = getSelectedText();
  if (selectedText) {
    document.execCommand('justifyFull', false, null);
  }
});

superscriptButton.addEventListener('click', () => {
  const selectedText = getSelectedText();
  if (selectedText) {
    document.execCommand('superscript', false, null);
  }
});

subscriptButton.addEventListener('click', () => {
  const selectedText = getSelectedText();
  if (selectedText) {
    document.execCommand('subscript', false, null);
  }
});

unorderedListButton.addEventListener('click', () => {
  document.execCommand('insertUnorderedList', false, null);
});

orderedListButton.addEventListener('click', () => {
  document.execCommand('insertOrderedList', false, null);
});
    //-------------------------------------------------COPY/CUT/PAST-----------------------------------------------------------------
    // Sélection des boutons de la classe 2
    const copyButton = document.querySelector('.class2-button:nth-of-type(1)');
    const pasteButton = document.querySelector('.class2-button:nth-of-type(2)');
    const cutButton = document.querySelector('.class2-button:nth-of-type(3)');

    // Écouteurs d'événements pour chaque bouton
    copyButton.addEventListener('click', () => {
    const selectedText = getSelectedText();
    if (selectedText) {
      document.execCommand('copy');
    }
    });

    pasteButton.addEventListener('click', () => {
      document.execCommand('paste');
    });

    cutButton.addEventListener('click', () => {
      const selectedText = getSelectedText();
      if (selectedText) {
        document.execCommand('cut');
      }
    });
    // Pour le menu deroulant 
  document.getElementById('menucut').addEventListener('click', function() {
    const selectedText = getSelectedText();
      if (selectedText) {
        document.execCommand('cut');
      }
  });

  document.getElementById('menucopy').addEventListener('click', function() {
    const selectedText = getSelectedText();
    if (selectedText) {
      document.execCommand('copy');
    }
  });

  document.getElementById('menupast').addEventListener('click', function() {
    document.execCommand('paste');
  });
    //-----------------------------------------------BOLT/ITALIC/UNDERLINE----------------------------------------------------------
    // Sélection des boutons de la classe2-button-solo
    const boldButton = document.getElementById('apply-stand');
    const italicButton = document.querySelector('.class2-button-solo:nth-of-type(2)');
    const underlineButton = document.querySelector('.class2-button-solo:nth-of-type(3)');

    // Fonction pour vérifier si le texte est mis en forme
    function isApplied(command) {
      return document.queryCommandState(command);
    }

    // Écouteurs d'événements pour chaque bouton
    boldButton.addEventListener('click', () => {
    const selectedText = getSelectedText();
      if (selectedText) {
        document.execCommand('bold');
      }
    });

    italicButton.addEventListener('click', () => {
      const selectedText = getSelectedText();
      if (selectedText) {
        document.execCommand('italic');
      }
    });

    underlineButton.addEventListener('click', () => {
      const selectedText = getSelectedText();
      if (selectedText) {
        document.execCommand('underline');
      }
    });
    //-------------------------------------------------Taille de police-------------------------------------
    // Sélection des menus déroulants
    const fontFamilySelect = document.getElementById('font-family');
    const fontSizeSelect = document.getElementById('font-size');

    // Écouteurs d'événements pour chaque menu déroulant
    fontFamilySelect.addEventListener('change', () => {
      const selectedFont = fontFamilySelect.value;
      document.execCommand('fontName', false, selectedFont);
    });
    fontSizeSelect.addEventListener('change', () => {
    const selection = window.getSelection();
    if (selection.rangeCount > 0) {
        const range = selection.getRangeAt(0);
        const span = document.createElement('span');
        span.style.fontSize = fontSizeSelect.value + 'px'; // Ajoutez 'px' à la valeur de la taille de police
        range.surroundContents(span);
    }
});
    //-------------------------------------------------Save-------------------------------------------------
    const saveButton = document.getElementById('save');
const openButton = document.getElementById('open');
const fileInput = document.getElementById('file-input');
const editor = document.getElementById('editor');

saveButton.addEventListener('click', () => {
  const podxContent = editor.innerHTML;
  const blob = new Blob([podxContent], { type: 'application/podx' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = 'Document.podx';
  a.click();
  URL.revokeObjectURL(url);
  adjustEditorHeight()
});

openButton.addEventListener('click', () => {
  fileInput.click();
  adjustEditorHeight()
});

fileInput.addEventListener('change', () => {
  const file = fileInput.files[0];
  const reader = new FileReader();
  adjustEditorHeight()
  reader.onload = (event) => {
    const podxContent = event.target.result;
    editor.innerHTML = podxContent;
  };
  reader.readAsText(file);
  adjustEditorHeight()
});
function openmedel(exemple){
  if(exemple === 'lettre')
    fetch('model/model-lettre.podx')
      .then(response => response.text())
      .then(podxContent => {
        editor.innerHTML = podxContent;
        adjustEditorHeight();
      })
      .catch(error => {
        console.error('Une erreur est survenue lors du chargement du fichier modèle :', error);
      }); 
  if(exemple === 'liste')
    fetch('model/model-listesimple.podx')
      .then(response => response.text())
      .then(podxContent => {
        editor.innerHTML = podxContent;
        adjustEditorHeight();
      })
      .catch(error => {
        console.error('Une erreur est survenue lors du chargement du fichier modèle :', error);
      }); 
  if(exemple === 'rapport')
    fetch('model/model-rapport.podx')
      .then(response => response.text())
      .then(podxContent => {
        editor.innerHTML = podxContent;
        adjustEditorHeight();
      })
      .catch(error => {
        console.error('Une erreur est survenue lors du chargement du fichier modèle :', error);
      }); 
      if(exemple === 'PV')
    fetch('model/model-procesverbal.podx')
      .then(response => response.text())
      .then(podxContent => {
        editor.innerHTML = podxContent;
        adjustEditorHeight();
      })
      .catch(error => {
        console.error('Une erreur est survenue lors du chargement du fichier modèle :', error);
      }); 
}


//--------------------------------------------------color--------------------------------------------------------
const colorButtons = document.querySelectorAll('.class1-color-button');
const anotherColorButton = document.getElementById('another');
const customColorPicker = document.getElementById('custom-color-picker');

colorButtons.forEach(button => {
  button.addEventListener('click', () => {
    const color = button.dataset.color;
    applyColorToSelection(color);
  });
});

anotherColorButton.addEventListener('click', () => {
  customColorPicker.click();
});

customColorPicker.addEventListener('input', () => {
  const color = customColorPicker.value;
  applyColorToSelection(color);
});

function applyColorToSelection(color) {
  const selection = window.getSelection();
  if (selection.rangeCount > 0) {
    const range = selection.getRangeAt(0);
    const span = document.createElement('span');
    span.style.color = color;
    range.surroundContents(span);
  }
}
//---------------------------------------------------------------------ZOOM----------------------------------------
// Ajoute un écouteur d'événements pour la molette de la souris
document.addEventListener('wheel', function(event) {
  // Vérifie si la touche Ctrl est enfoncée
  if (event.ctrlKey === true) {
    const zoomBar = document.getElementById('zoomBar');
    const valeurZoom = document.getElementById('valeur-zoom');
    // Empêche le comportement par défaut du zoom du navigateur
    event.preventDefault();

    // Récupère l'élément que vous souhaitez zoomer (dans ce cas, la zone de texte)
    var editor = document.getElementById('editor');

    // Récupère le facteur de zoom actuel
    var currentZoom = parseFloat(editor.style.zoom) || 1;

    // Ajuste le facteur de zoom en fonction de la direction de la molette
    var delta = event.deltaY > 0 ? -0.1 : 0.1; // Sens de défilement de la molette
    var newZoom = currentZoom + delta;

    // Limite le facteur de zoom entre 0.5 et 3 (à ajuster selon vos besoins)
    newZoom = Math.min(Math.max(0.5, newZoom), 2);

    valeurZoom.textContent = Math.floor(newZoom * 100) + '%';
    zoomBar.value = newZoom*100 ;

    // Applique le nouveau facteur de zoom
    editor.style.zoom = newZoom;
  }
}, { passive: false });

document.addEventListener('DOMContentLoaded', function() {
  var editor = document.getElementById('editor');
  var zoomBar = document.getElementById('zoomBar');
  var valeurZoom = document.getElementById('valeur-zoom');

  // Ajoute un écouteur d'événements pour la modification de la barre de zoom
zoomBar.addEventListener('input', function() {
  // Récupère la valeur de la barre de zoom
  var valeur = zoomBar.value;

  // Met à jour l'affichage de la valeur de zoom
  valeurZoom.textContent = valeur + '%';

  // Applique le zoom à l'élément que vous souhaitez zoomer (dans ce cas, la zone de texte)
  editor.style.zoom = valeur / 100;

  // Centre horizontalement l'éditeur
  editor.style.marginLeft = '50%';
});
});
//--------------------------------------------GESTION PAGE----------------------------------------------------------
let previousHeight = editor.scrollHeight;

function adjustEditorHeight() {
  const currentHeight = editor.scrollHeight;

  if (currentHeight !== previousHeight) {
    editor.style.height = 'fit-content';
    previousHeight = currentHeight;
  }
}

// Appelez la fonction pour ajuster la hauteur au chargement initial et à chaque modification du contenu
window.addEventListener('DOMContentLoaded', adjustEditorHeight);
editor.addEventListener('input', adjustEditorHeight);

//---------------------------------------------Gestion du loader------------------------------------------------------
setTimeout(function() {
  opengenema();
  opengenema();
        var loader = document.getElementById('loader');
        loader.style.display = 'none';
        }, 20);
//----------------------------------------------Gestion du modal pour les parametre------------------------------------
// Fonction pour ouvrir un onglet spécifique
function openTab(event, tabName) {
  // Récupère tous les éléments avec la classe "tabcontent" et les masque
  const tabcontent = document.getElementsByClassName('tabcontent');
  for (let i = 0; i < tabcontent.length; i++) {
    tabcontent[i].style.display = 'none';
  }

  // Récupère tous les éléments avec la classe "tablinks" et supprime la classe "active"
  const tablinks = document.getElementsByClassName('tablinks');
  for (let i = 0; i < tablinks.length; i++) {
    tablinks[i].classList.remove('active');
  }

  // Affiche l'onglet sélectionné et ajoute la classe "active" au bouton de l'onglet sélectionné
  document.getElementById(tabName).style.display = 'block';
  event.currentTarget.classList.add('active');
}

// Événement pour ouvrir la fenêtre modale
document.getElementById('openModalBtn').addEventListener('click', () => {
  document.getElementById('myModal').style.display = 'block';
});

// Événement pour ouvrir la fenêtre modale
document.getElementById('openModalinster').addEventListener('click', () => {
  document.getElementById('myModal').style.display = 'block';
});

document.getElementById('openModalpara').addEventListener('click', () => {
  document.getElementById('myModal').style.display = 'block';
});

document.getElementById('GenemaPara').addEventListener('click', () => {
  opengenema();
});

// Événement pour fermer la fenêtre modale
document.querySelector('.closebtn').addEventListener('click', () => {
  document.getElementById('myModal').style.display = 'none';
});

// Événement pour fermer la fenêtre modale en cliquant en dehors de celle-ci
window.addEventListener('click', (event) => {
  if (event.target === document.getElementById('myModal')) {
    document.getElementById('myModal').style.display = 'none';
  }
});
//------------------------------------------Option--------------------------------------------------------------------------------
//Mise en page
//-----------------------------------------oriantation-------------------------------------
function changeOrientationAndPaperSize() {
  const selectedOrientation = document.querySelector('input[name="orientation"]:checked').value;
  const selectedPaperSize = document.getElementById('paper-size').value;
  const editor = document.getElementById('editor');
  
  switch (selectedPaperSize) {
    case 'A4':
      if (selectedOrientation === 'portrait') {
        editor.style.width = '210mm';
        editor.style.height = '297mm';
      } else if (selectedOrientation === 'landscape') {
        editor.style.width = '297mm';
        editor.style.height = '210mm';
      }
      break;
    case 'A5':
      if (selectedOrientation === 'portrait') {
        editor.style.width = '148mm';
        editor.style.height = '210mm';
      } else if (selectedOrientation === 'landscape') {
        editor.style.width = '210mm';
        editor.style.height = '148mm';
      }
      break;
    case 'Letter':
      if (selectedOrientation === 'portrait') {
        editor.style.width = '8.5in';
        editor.style.height = '11in';
      } else if (selectedOrientation === 'landscape') {
        editor.style.width = '11in';
        editor.style.height = '8.5in';
      }
      break;
    case 'Legal':
      if (selectedOrientation === 'portrait') {
        editor.style.width = '8.5in';
        editor.style.height = '14in';
      } else if (selectedOrientation === 'landscape') {
        editor.style.width = '14in';
        editor.style.height = '8.5in';
      }
      break;
    // Ajoutez d'autres cas pour d'autres formats de papier si nécessaire
    default:
      break;
  }
}

// Événement pour détecter le changement d'orientation et de format de papier
document.querySelectorAll('input[name="orientation"], #paper-size').forEach((input) => {
  input.addEventListener('change', changeOrientationAndPaperSize);
});
//----------------------------------------------Taille--------------------------------------
// Fonction pour détecter le changement de format de papier et ajuster la taille de la zone de texte éditable en conséquence
function changePaperSize() {
  const selectedPaperSize = document.getElementById('paper-size').value;
  const editor = document.getElementById('editor');
  
  switch (selectedPaperSize) {
    case 'A4':
      editor.style.width = '210mm';
      editor.style.height = '297mm';
      break;
    case 'A5':
      editor.style.width = '148mm';
      editor.style.height = '210mm';
      break;
    case 'Letter':
      editor.style.width = '8.5in';
      editor.style.height = '11in';
      break;
    case 'Legal':
      editor.style.width = '8.5in';
      editor.style.height = '14in';
      break;
    // Ajoutez d'autres cas pour d'autres formats de papier si nécessaire
    default:
      break;
  }
}

// Événement pour détecter le changement de format de papier
document.getElementById('paper-size').addEventListener('change', changePaperSize);
//---------------------------------------------marge-----------------------------------------
// Fonction pour détecter le changement de marges et ajuster la taille de la zone de texte éditable en conséquence
function changeMarginSize() {
  const selectedMarginSize = document.getElementById('margin-size').value;
  const editor = document.getElementById('editor');
  console.log(selectedMarginSize);
  switch (selectedMarginSize) {
    case 'narrow':
      editor.style.padding = '10mm';
      console.log("10mm");
      break;
    case 'normal':
      editor.style.padding = '20mm';
      console.log("20mm");
      break;
    case 'wide':
      editor.style.padding = '30mm';
      console.log("30mm");
      break;
    case 'no':
      editor.style.padding = '0mm';
      console.log("0mm");
      break;
    // Ajoutez d'autres cas pour d'autres options de marges si nécessaire
    default:
    console.log("no mm");
      break;
  }
}

// Événement pour détecter le changement de marges
document.getElementById('margin-size').addEventListener('change', changeMarginSize);
//-----------------------------------------------Tableau----------------------------------------------
// Sélectionnez le bouton d'insertion de tableau
const insertTableButton = document.getElementById('insert-table-btn');

// Ajoutez un écouteur d'événements pour l'insertion de tableau
insertTableButton.addEventListener('click', () => {
    // Récupérez le nombre de lignes et de colonnes à partir des champs d'entrée
    const numRows = parseInt(document.getElementById('num-rows').value);
    const numCols = parseInt(document.getElementById('num-cols').value);

    // Générez le code HTML pour le tableau en fonction du nombre de lignes et de colonnes
    let tableHtml = '<table border="1">';
    for (let i = 0; i < numRows; i++) {
        tableHtml += '<tr>';
        for (let j = 0; j < numCols; j++) {
            tableHtml += '<td contenteditable="true" style="width: 100px;"></td>'; // Vous pouvez ajuster la largeur selon vos besoins
        }
        tableHtml += '</tr>';
    }
    tableHtml += '</table>';

    // Insérez le tableau dans l'éditeur
    document.getElementById('editor').insertAdjacentHTML('beforeend', tableHtml);
});
//-----------------------------------------------------------------------Custom menu-----------------------------------------------------------
// Prevent default context menu
document.addEventListener('contextmenu', function(event) {
    event.preventDefault();

    // Cacher le menu contextuel de l'image si présent
    const imageMenu = document.getElementById('image-context-menu');
    if (imageMenu) {
        imageMenu.style.display = 'none';
    }

    // Afficher le menu contextuel personnalisé
    const customMenu = document.getElementById('custom-menu');
    customMenu.style.display = 'block';
    customMenu.style.left = event.pageX + 'px';
    customMenu.style.top = event.pageY + 'px';
});

// Hide the custom context menu when clicking outside
document.addEventListener('click', function(event) {
    const customMenu = document.getElementById('custom-menu');
    customMenu.style.display = 'none';
    
    // Supprimer également le menu contextuel de l'image
    const imageMenu = document.getElementById('image-context-menu');
    if (imageMenu) {
        imageMenu.remove();
    }
});

//---------------------------------------------------------Image-----------------------------------------------
// Sélectionnez la zone de texte éditable
const imageInput = document.getElementById('image-input');

// Ajoutez un écouteur d'événements pour détecter la sélection d'un fichier image
imageInput.addEventListener('change', () => {
    const file = imageInput.files[0]; // Obtenez le fichier image sélectionné
    const reader = new FileReader(); // Créez un objet FileReader pour lire le contenu du fichier

    reader.onload = function(event) {
        const imageUrl = event.target.result; // Obtenez l'URL de l'image chargée

        // Insérez l'image dans l'éditeur à l'emplacement du curseur
        const imageHtml = `<div style="position: relative; display: inline-block;">
                              <img src="${imageUrl}" alt="Image" style="position: relative; max-width: 100%; cursor: move;">
                              <div class="resizer top-left"></div>
                              <div class="resizer top-right"></div>
                              <div class="resizer bottom-left"></div>
                              <div class="resizer bottom-right"></div>
                          </div>`;
        editor.focus(); // Assurez-vous que l'éditeur est sélectionné
        document.execCommand('insertHTML', false, imageHtml); // Insérez l'image dans l'éditeur

        // Ajouter un gestionnaire d'événements pour les images insérées
        const insertedImages = editor.querySelectorAll('img');
        insertedImages.forEach(img => {
            let isResizing = false;
            let isDragging = false;
            let startX, startY, startLeft, startTop, startWidth, startHeight;

            // Assurez-vous que l'image ne dépasse pas les dimensions de l'éditeur
            const editorRect = editor.getBoundingClientRect();

            img.addEventListener('mousedown', (event) => {
                event.preventDefault(); // Empêche le comportement par défaut de glisser-déposer de l'image
                startX = event.clientX;
                startY = event.clientY;
                startLeft = img.offsetLeft;
                startTop = img.offsetTop;
                startWidth = img.clientWidth;
                startHeight = img.clientHeight;

                if (event.target.classList.contains('resizer')) {
                    isResizing = true;
                } else {
                    isDragging = true;
                }
            });

            img.addEventListener('mousemove', (event) => {
                if (isResizing) {
                    const width = startWidth + (event.clientX - startX);
                    const height = startHeight + (event.clientY - startY);
                    img.style.width = `${width}px`;
                    img.style.height = `${height}px`;
                } else if (isDragging) {
                    const offsetX = event.clientX - startX;
                    const offsetY = event.clientY - startY;

                    // Limiter le déplacement pour que l'image reste dans l'éditeur
                    let newLeft = startLeft + offsetX;
                    let newTop = startTop + offsetY;

                    // Vérifier les limites de l'éditeur
                    if (newLeft < 0) newLeft = 0;
                    if (newTop < 0) newTop = 0;
                    if (newLeft + img.clientWidth > editorRect.width) {
                        newLeft = editorRect.width - img.clientWidth;
                    }
                    if (newTop + img.clientHeight > editorRect.height) {
                        newTop = editorRect.height - img.clientHeight;
                    }

                    img.style.left = `${newLeft}px`;
                    img.style.top = `${newTop}px`;
                }
            });

            img.addEventListener('mouseup', () => {
                isResizing = false;
                isDragging = false;
            });

            img.addEventListener('contextmenu', (event) => {
                event.preventDefault(); // Empêche l'affichage du menu contextuel natif
                displayImageContextMenu(event, img);
            });
        });
    };

    reader.readAsDataURL(file); // Lire le contenu du fichier sous forme d'URL de données
});

// Fonction pour afficher un menu contextuel personnalisé pour les images
const displayImageContextMenu = (event, img) => {
    const menu = document.createElement('div');
    menu.id = 'image-context-menu';
    menu.style.position = 'absolute';
    menu.style.left = `${event.clientX}px`;
    menu.style.top = `${event.clientY}px`;
    menu.style.background = '#fff';
    menu.style.border = '1px solid #ccc';
    menu.style.padding = '10px';
    menu.style.boxShadow = '0 2px 6px rgba(0,0,0,0.2)';
    menu.style.zIndex = '1001'; // S'assurer que le menu est au-dessus des autres éléments

    // Options du menu contextuel
    menu.innerHTML = `
        <button onclick="alignImage('left', '${img.src}')">Aligner à gauche</button><br>
        <button onclick="alignImage('center', '${img.src}')">Aligner au centre</button><br>
        <button onclick="alignImage('right', '${img.src}')">Aligner à droite</button><br>
        <button onclick="removeImage('${img.src}')">Supprimer</button>
    `;

    // Supprimez tout menu contextuel existant
    const existingMenu = document.getElementById('image-context-menu');
    if (existingMenu) existingMenu.remove();

    document.body.appendChild(menu);

    // Supprimez le menu si vous cliquez ailleurs
    document.addEventListener('click', () => {
        menu.remove();
    }, { once: true });
};

// Fonctions utilitaires pour les options du menu contextuel
const alignImage = (alignment, imgSrc) => {
    const img = Array.from(editor.querySelectorAll('img')).find(i => i.src === imgSrc);
    if (img) {
        img.style.display = alignment === 'center' ? 'block' : 'inline-block';
        img.style.margin = alignment === 'center' ? '0 auto' : '0';
        img.style.float = alignment === 'left' ? 'left' : alignment === 'right' ? 'right' : 'none';
    }
};

const removeImage = (imgSrc) => {
    const img = Array.from(editor.querySelectorAll('img')).find(i => i.src === imgSrc);
    if (img) img.remove();
};

//---------------------------------------------------------------shape fonction-----------------------------------
function createShape(x, y, label) {
        var shape = document.createElement('div');
        shape.classList.add('shape');
        shape.style.left = x + 'px';
        shape.style.top = y + 'px';
        shape.textContent = label;
        shape.draggable = true;

        // Ajouter un gestionnaire d'événements pour le déplacement
        shape.addEventListener('dragstart', function(event) {
            event.dataTransfer.setData('text/plain', ''); // Nécessaire pour certains navigateurs
        });

        // Ajouter la forme à la zone de dessin
        document.getElementById('diagram').appendChild(shape);
    }
    function insererDiagramme() {
            // Récupérez le contenu du diagramme à insérer
            var diagramme = '<div id="diagram" style="position: relative; width: 600px; height: 400px; border: 1px solid black;"></div>';
            
            // Insérez le diagramme dans l'éditeur de texte
            document.getElementById('editor').innerHTML += diagramme;
            createShape(50, 50, 'Processus 1');
            createShape(200, 100, 'Processus 2');
            createShape(350, 150, 'Processus 3');
            // Fermez la fenêtre modale après l'insertion
            closeModal();
        }

//-----------------------------------------------------------------------Math Formula Editor Modal-----------------------------------------------------------

// Charger MathJax pour le rendu des formules
const loadMathJax = () => {
    if (!window.MathJax) {
        const script = document.createElement('script');
        script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
        script.async = true;
        document.head.appendChild(script);
    }
};

// Créer le modal pour l'éditeur de formules mathématiques
const createMathEditorModal = () => {
    const modal = document.createElement('div');
    modal.id = 'math-editor-modal';
    modal.style.position = 'fixed';
    modal.style.top = '50%';
    modal.style.left = '50%';
    modal.style.transform = 'translate(-50%, -50%)';
    modal.style.background = '#fff';
    modal.style.border = '1px solid #ccc';
    modal.style.padding = '20px';
    modal.style.boxShadow = '0 2px 6px rgba(0,0,0,0.2)';
    modal.style.zIndex = '1003';
    modal.style.display = 'block';
    modal.style.width = '500px';

    modal.innerHTML = `
        <h3>Éditeur de Formules Mathématiques</h3>
        <div style="display: flex; flex-direction: column; gap: 10px;">
            <!-- Zone de texte pour LaTeX -->
            <textarea id="math-latex-input" rows="4" placeholder="Écrivez votre formule en LaTeX..." style="width: 100%;"></textarea>

            <!-- Zone de rendu -->
            <div id="math-render" style="min-height: 50px; border: 1px solid #ddd; padding: 10px; font-size: 18px; background-color: #f9f9f9;">
                <!-- Le rendu sera inséré ici -->
            </div>

            <!-- Panneau des boutons -->
            <div id="math-toolbar" style="display: flex; flex-wrap: wrap; gap: 5px;">
                <button class="math-button" data-latex="\\frac{}{}">Fraction</button>
                <button class="math-button" data-latex="\\sqrt{}">Racine</button>
                <button class="math-button" data-latex="\\sum">Somme</button>
                <button class="math-button" data-latex="\\int">Intégrale</button>
                <button class="math-button" data-latex="\\pi">Pi</button>
                <button class="math-button" data-latex="\\theta">Thêta</button>
                <button class="math-button" data-latex="\\infty">Infini</button>
                <button class="math-button" data-latex="\\div">Division</button>
            </div>

            <!-- Boutons d'action -->
            <div style="margin-top: 10px; display: flex; justify-content: space-between;">
                <button id="insert-math-editor" style="background-color: #4CAF50; color: white; padding: 5px 10px;">Insérer</button>
                <button id="close-math-editor" style="background-color: #f44336; color: white; padding: 5px 10px;">Annuler</button>
            </div>
        </div>
    `;

    document.body.appendChild(modal);

    // Gestion des événements
    const latexInput = document.getElementById('math-latex-input');
    const renderDiv = document.getElementById('math-render');

    latexInput.addEventListener('input', () => {
        renderMath(latexInput.value, renderDiv);
    });

    document.querySelectorAll('.math-button').forEach(button => {
        button.addEventListener('click', (event) => {
            const latex = event.target.dataset.latex;
            latexInput.value += latex;
            renderMath(latexInput.value, renderDiv);
        });
    });

    document.getElementById('insert-math-editor').addEventListener('click', () => {
        insertMathToEditor(latexInput.value);
        closeMathEditorModal();
    });

    document.getElementById('close-math-editor').addEventListener('click', closeMathEditorModal);
};

// Fonction pour afficher le modal
const openMathEditorModal = () => {
    const modal = document.getElementById('math-editor-modal');
    if (modal) {
        modal.style.display = 'block';
    }
};

// Fonction pour fermer le modal
const closeMathEditorModal = () => {
    const modal = document.getElementById('math-editor-modal');
    if (modal) {
        modal.style.display = 'none';
        document.getElementById('math-latex-input').value = '';
        document.getElementById('math-render').innerHTML = '';
    }
};

// Fonction pour rendre les formules avec MathJax
const renderMath = (latex, element) => {
    if (window.MathJax) {
        element.innerHTML = `\\(${latex}\\)`;
        MathJax.typesetPromise([element]);
    }
};

// Fonction pour insérer la formule dans l'éditeur
const insertMathToEditor = (latex) => {
    const formulaHtml = `<span class="math-formula" style="font-family: 'Courier New', Courier, monospace; background-color: #f9f9f9; border: 1px solid #ccc; padding: 2px 4px; border-radius: 4px;">\\(${latex}\\)</span>`;
    editor.focus();
    document.execCommand('insertHTML', false, formulaHtml);
    if (window.MathJax) {
        MathJax.typesetPromise();
    }
};
  

function opengenema() {
  var genemaDiv = document.getElementById("genema-id");
    if (genemaDiv.style.display === "none" || genemaDiv.style.display === "") {
        genemaDiv.style.display = "block";
    } else {
        genemaDiv.style.display = "none";
    }
}
  </script>
</body>
</html>